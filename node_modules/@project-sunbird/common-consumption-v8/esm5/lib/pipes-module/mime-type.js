/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Pipe } from '@angular/core';
var MimeTypeMasterData = /** @class */ (function () {
    function MimeTypeMasterData() {
    }
    MimeTypeMasterData.COLLECTION = 'application/vnd.ekstep.content-collection';
    MimeTypeMasterData.VIDEO = ['video/avi', 'video/mpeg', 'video/quicktime', 'video/3gpp', 'video/mpeg', 'video/mp4',
        'video/ogg', 'video/webm'];
    MimeTypeMasterData.AUDIO = ['audio/mp3', 'audio/mp4', 'audio/mpeg', 'audio/ogg', 'audio/webm', 'audio/x-wav', 'audio/wav'];
    MimeTypeMasterData.INTERACTIVE = ['application/vnd.ekstep.ecml-archive', 'application/vnd.ekstep.html-archive',
        'application/vnd.android.package-archive', 'application/vnd.ekstep.content-archive',
        'application/vnd.ekstep.plugin-archive', 'application/vnd.ekstep.h5p-archive'];
    MimeTypeMasterData.DOCS = ['application/pdf', 'application/epub', 'application/msword'];
    MimeTypeMasterData.ALL = ['video/mp4', 'video/x-youtube', 'video/webm', 'application/pdf', 'application/epub',
        'application/pdf', 'application/epub', 'application/vnd.ekstep.ecml-archive', 'application/vnd.ekstep.h5p-archive',
        'application/vnd.ekstep.html-archive'
    ];
    return MimeTypeMasterData;
}());
export { MimeTypeMasterData };
if (false) {
    /** @type {?} */
    MimeTypeMasterData.COLLECTION;
    /** @type {?} */
    MimeTypeMasterData.VIDEO;
    /** @type {?} */
    MimeTypeMasterData.AUDIO;
    /** @type {?} */
    MimeTypeMasterData.INTERACTIVE;
    /** @type {?} */
    MimeTypeMasterData.DOCS;
    /** @type {?} */
    MimeTypeMasterData.ALL;
}
/*
  Contents are filtered based on given mimetype
*/
var MimeTypePipe = /** @class */ (function () {
    function MimeTypePipe() {
    }
    /**
     * @param {?=} item
     * @param {?=} mimeTypes
     * @param {?=} isTextbookTocPage
     * @return {?}
     */
    MimeTypePipe.prototype.transform = /**
     * @param {?=} item
     * @param {?=} mimeTypes
     * @param {?=} isTextbookTocPage
     * @return {?}
     */
    function (item, mimeTypes, isTextbookTocPage) {
        if (mimeTypes === void 0) { mimeTypes = ['all']; }
        if (isTextbookTocPage === void 0) { isTextbookTocPage = false; }
        if (mimeTypes.indexOf('all') > -1 && item != null) {
            if (item.mimeType !== MimeTypeMasterData.COLLECTION && !item.children) {
                return true;
            }
            else {
                if (item.mimeType === MimeTypeMasterData.COLLECTION && item.children && !item.children.length) {
                    return false;
                }
                if (item.children && item.children.length) {
                    return this.getFilteredItems(item.children, MimeTypeMasterData.ALL);
                }
                else {
                    return true;
                }
            }
        }
        if (item != null && item.mimeType !== MimeTypeMasterData.COLLECTION && (!item.children || !item.children.length)) {
            return this.getFilteredItems([item], mimeTypes);
        }
        if (item != null) {
            return this.getFilteredItems(item.children, mimeTypes);
        }
        else {
            return null;
        }
    };
    /**
     * @param {?} contents
     * @param {?} mimeTypes
     * @return {?}
     */
    MimeTypePipe.prototype.getFilteredItems = /**
     * @param {?} contents
     * @param {?} mimeTypes
     * @return {?}
     */
    function (contents, mimeTypes) {
        if (contents) {
            return this.flattenDeep(contents)
                .some((/**
             * @param {?} c
             * @return {?}
             */
            function (c) { return !!mimeTypes.find((/**
             * @param {?} m
             * @return {?}
             */
            function (m) { return m === c.mimeType; })); }));
        }
    };
    /**
     * @private
     * @param {?} contents
     * @return {?}
     */
    MimeTypePipe.prototype.flattenDeep = /**
     * @private
     * @param {?} contents
     * @return {?}
     */
    function (contents) {
        var _this = this;
        if (contents) {
            return contents.reduce((/**
             * @param {?} acc
             * @param {?} val
             * @return {?}
             */
            function (acc, val) {
                if (val.children) {
                    acc.push(val);
                    return acc.concat(_this.flattenDeep(val.children));
                }
                else {
                    return acc.concat(val);
                }
            }), []);
        }
    };
    MimeTypePipe.decorators = [
        { type: Pipe, args: [{
                    name: 'hasMimeType',
                },] }
    ];
    return MimeTypePipe;
}());
export { MimeTypePipe };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWltZS10eXBlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQHByb2plY3Qtc3VuYmlyZC9jb21tb24tY29uc3VtcHRpb24tdjgvIiwic291cmNlcyI6WyJsaWIvcGlwZXMtbW9kdWxlL21pbWUtdHlwZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLElBQUksRUFBaUIsTUFBTSxlQUFlLENBQUM7QUFDcEQ7SUFBQTtJQWFBLENBQUM7SUFad0IsNkJBQVUsR0FBRywyQ0FBMkMsQ0FBQztJQUN6RCx3QkFBSyxHQUFHLENBQUMsV0FBVyxFQUFFLFlBQVksRUFBRSxpQkFBaUIsRUFBRSxZQUFZLEVBQUUsWUFBWSxFQUFFLFdBQVc7UUFDbkgsV0FBVyxFQUFFLFlBQVksQ0FBQyxDQUFDO0lBQ04sd0JBQUssR0FBRyxDQUFDLFdBQVcsRUFBRSxXQUFXLEVBQUUsWUFBWSxFQUFFLFdBQVcsRUFBRSxZQUFZLEVBQUUsYUFBYSxFQUFFLFdBQVcsQ0FBQyxDQUFDO0lBQ3hHLDhCQUFXLEdBQUcsQ0FBQyxxQ0FBcUMsRUFBRSxxQ0FBcUM7UUFDaEgseUNBQXlDLEVBQUUsd0NBQXdDO1FBQ25GLHVDQUF1QyxFQUFFLG9DQUFvQyxDQUFDLENBQUM7SUFDMUQsdUJBQUksR0FBRyxDQUFDLGlCQUFpQixFQUFFLGtCQUFrQixFQUFFLG9CQUFvQixDQUFDLENBQUM7SUFDckUsc0JBQUcsR0FBRyxDQUFDLFdBQVcsRUFBRSxpQkFBaUIsRUFBRSxZQUFZLEVBQUUsaUJBQWlCLEVBQUUsa0JBQWtCO1FBQy9HLGlCQUFpQixFQUFFLGtCQUFrQixFQUFFLHFDQUFxQyxFQUFFLG9DQUFvQztRQUNsSCxxQ0FBcUM7S0FDdEMsQ0FBQztJQUNKLHlCQUFDO0NBQUEsQUFiRCxJQWFDO1NBYlksa0JBQWtCOzs7SUFDN0IsOEJBQWdGOztJQUNoRix5QkFDNkI7O0lBQzdCLHlCQUErSDs7SUFDL0gsK0JBRWlGOztJQUNqRix3QkFBNEY7O0lBQzVGLHVCQUdFOzs7OztB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dCB7IFBpcGUsIFBpcGVUcmFuc2Zvcm0gfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuZXhwb3J0IGNsYXNzIE1pbWVUeXBlTWFzdGVyRGF0YSB7XHJcbiAgcHVibGljIHN0YXRpYyByZWFkb25seSBDT0xMRUNUSU9OID0gJ2FwcGxpY2F0aW9uL3ZuZC5la3N0ZXAuY29udGVudC1jb2xsZWN0aW9uJztcclxuICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IFZJREVPID0gWyd2aWRlby9hdmknLCAndmlkZW8vbXBlZycsICd2aWRlby9xdWlja3RpbWUnLCAndmlkZW8vM2dwcCcsICd2aWRlby9tcGVnJywgJ3ZpZGVvL21wNCcsXHJcbiAgICAndmlkZW8vb2dnJywgJ3ZpZGVvL3dlYm0nXTtcclxuICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IEFVRElPID0gWydhdWRpby9tcDMnLCAnYXVkaW8vbXA0JywgJ2F1ZGlvL21wZWcnLCAnYXVkaW8vb2dnJywgJ2F1ZGlvL3dlYm0nLCAnYXVkaW8veC13YXYnLCAnYXVkaW8vd2F2J107XHJcbiAgcHVibGljIHN0YXRpYyByZWFkb25seSBJTlRFUkFDVElWRSA9IFsnYXBwbGljYXRpb24vdm5kLmVrc3RlcC5lY21sLWFyY2hpdmUnLCAnYXBwbGljYXRpb24vdm5kLmVrc3RlcC5odG1sLWFyY2hpdmUnLFxyXG4gICAgJ2FwcGxpY2F0aW9uL3ZuZC5hbmRyb2lkLnBhY2thZ2UtYXJjaGl2ZScsICdhcHBsaWNhdGlvbi92bmQuZWtzdGVwLmNvbnRlbnQtYXJjaGl2ZScsXHJcbiAgICAnYXBwbGljYXRpb24vdm5kLmVrc3RlcC5wbHVnaW4tYXJjaGl2ZScsICdhcHBsaWNhdGlvbi92bmQuZWtzdGVwLmg1cC1hcmNoaXZlJ107XHJcbiAgcHVibGljIHN0YXRpYyByZWFkb25seSBET0NTID0gWydhcHBsaWNhdGlvbi9wZGYnLCAnYXBwbGljYXRpb24vZXB1YicsICdhcHBsaWNhdGlvbi9tc3dvcmQnXTtcclxuICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IEFMTCA9IFsndmlkZW8vbXA0JywgJ3ZpZGVvL3gteW91dHViZScsICd2aWRlby93ZWJtJywgJ2FwcGxpY2F0aW9uL3BkZicsICdhcHBsaWNhdGlvbi9lcHViJyxcclxuICAgICdhcHBsaWNhdGlvbi9wZGYnLCAnYXBwbGljYXRpb24vZXB1YicsICdhcHBsaWNhdGlvbi92bmQuZWtzdGVwLmVjbWwtYXJjaGl2ZScsICdhcHBsaWNhdGlvbi92bmQuZWtzdGVwLmg1cC1hcmNoaXZlJyxcclxuICAgICdhcHBsaWNhdGlvbi92bmQuZWtzdGVwLmh0bWwtYXJjaGl2ZSdcclxuICBdO1xyXG59XHJcblxyXG4vKlxyXG4gIENvbnRlbnRzIGFyZSBmaWx0ZXJlZCBiYXNlZCBvbiBnaXZlbiBtaW1ldHlwZVxyXG4qL1xyXG5cclxuXHJcbkBQaXBlKHtcclxuICBuYW1lOiAnaGFzTWltZVR5cGUnLFxyXG59KVxyXG5leHBvcnQgY2xhc3MgTWltZVR5cGVQaXBlIGltcGxlbWVudHMgUGlwZVRyYW5zZm9ybSB7XHJcbiAgdHJhbnNmb3JtKGl0ZW0/OiBhbnksIG1pbWVUeXBlczogc3RyaW5nW10gPSBbJ2FsbCddLCBpc1RleHRib29rVG9jUGFnZTogYm9vbGVhbiA9IGZhbHNlKTogYm9vbGVhbiB7XHJcbiAgICBpZiAobWltZVR5cGVzLmluZGV4T2YoJ2FsbCcpID4gLTEgJiYgaXRlbSAhPSBudWxsKSB7XHJcbiAgICAgIGlmIChpdGVtLm1pbWVUeXBlICE9PSBNaW1lVHlwZU1hc3RlckRhdGEuQ09MTEVDVElPTiAmJiAhaXRlbS5jaGlsZHJlbikge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGlmIChpdGVtLm1pbWVUeXBlID09PSBNaW1lVHlwZU1hc3RlckRhdGEuQ09MTEVDVElPTiAmJiBpdGVtLmNoaWxkcmVuICYmICFpdGVtLmNoaWxkcmVuLmxlbmd0aCkge1xyXG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoaXRlbS5jaGlsZHJlbiAmJiBpdGVtLmNoaWxkcmVuLmxlbmd0aCkge1xyXG4gICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RmlsdGVyZWRJdGVtcyhpdGVtLmNoaWxkcmVuLCBNaW1lVHlwZU1hc3RlckRhdGEuQUxMKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAoaXRlbSAhPSBudWxsICYmIGl0ZW0ubWltZVR5cGUgIT09IE1pbWVUeXBlTWFzdGVyRGF0YS5DT0xMRUNUSU9OICYmICghaXRlbS5jaGlsZHJlbiB8fCAhaXRlbS5jaGlsZHJlbi5sZW5ndGgpKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmdldEZpbHRlcmVkSXRlbXMoW2l0ZW1dLCBtaW1lVHlwZXMpO1xyXG4gICAgfVxyXG4gICAgaWYoaXRlbSE9bnVsbCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5nZXRGaWx0ZXJlZEl0ZW1zKGl0ZW0uY2hpbGRyZW4sIG1pbWVUeXBlcyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIFxyXG4gIH1cclxuXHJcblxyXG4gIGdldEZpbHRlcmVkSXRlbXMoY29udGVudHMsIG1pbWVUeXBlczogc3RyaW5nW10pOiBib29sZWFuIHtcclxuICAgIGlmIChjb250ZW50cykge1xyXG5cclxuICAgICAgcmV0dXJuIHRoaXMuZmxhdHRlbkRlZXAoY29udGVudHMpXHJcbiAgICAgICAgLnNvbWUoKGMpID0+ICEhbWltZVR5cGVzLmZpbmQobSA9PiBtID09PSBjLm1pbWVUeXBlKSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGZsYXR0ZW5EZWVwKGNvbnRlbnRzKSB7XHJcbiAgICBpZiAoY29udGVudHMpIHtcclxuICAgICAgcmV0dXJuIGNvbnRlbnRzLnJlZHVjZSgoYWNjLCB2YWwpID0+IHtcclxuICAgICAgICBpZiAodmFsLmNoaWxkcmVuKSB7XHJcbiAgICAgICAgICBhY2MucHVzaCh2YWwpO1xyXG4gICAgICAgICAgcmV0dXJuIGFjYy5jb25jYXQodGhpcy5mbGF0dGVuRGVlcCh2YWwuY2hpbGRyZW4pKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmV0dXJuIGFjYy5jb25jYXQodmFsKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0sIFtdKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuIl19