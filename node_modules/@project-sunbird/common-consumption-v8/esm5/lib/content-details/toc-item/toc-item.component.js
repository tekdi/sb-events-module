/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, Input, Output, EventEmitter, ViewChild, QueryList, ViewChildren } from '@angular/core';
import { ExpandBehavior, ExpandMode, FlattenedType, TocCardType } from '../../card/models';
import { MimeTypePipe, MimeTypeMasterData } from '../../pipes-module/mime-type';
var TocItemComponent = /** @class */ (function () {
    function TocItemComponent() {
        var _this = this;
        this.accordianConfig = {
            expandMode: ExpandMode.MULTIPLE,
            expandBehavior: ExpandBehavior.NONE
        };
        this.activeMimeTypeFilter = ['all'];
        this.noContentMessage = 'No content available';
        this.contentStatus = [];
        this.trackableDefaultImage = '';
        this.type = "";
        this.recogniseCollection = false;
        this.tocCardClick = new EventEmitter();
        this.noContent = new EventEmitter();
        this.selectedItem = new EventEmitter();
        this.playButtonClick = new EventEmitter();
        this.resetActiveContent = false;
        this.isMimeTypeFilterChanged = false;
        this.isSameMimeTypeInChildren = ((/**
         * @param {?} mimeTypesCount
         * @param {?} activeMimeType
         * @return {?}
         */
        function (mimeTypesCount, activeMimeType) {
            /** @type {?} */
            var contentMimeType = Object.keys(JSON.parse(mimeTypesCount));
            return Boolean(activeMimeType.filter((/**
             * @param {?} value
             * @return {?}
             */
            function (value) { return contentMimeType.includes(value); })).length);
        }));
        this.isSameMimeType = (/**
         * @param {?} currentContent
         * @return {?}
         */
        function (currentContent) { return _this.activeMimeTypeFilter.find((/**
         * @param {?} mimeType
         * @return {?}
         */
        function (mimeType) { return mimeType === currentContent.mimeType; })); });
        this.isChildrenPresent = (/**
         * @param {?} currentContent
         * @return {?}
         */
        function (currentContent) { return Boolean(currentContent.children && currentContent.children.length); });
        this.subscriptions = [];
    }
    Object.defineProperty(TocItemComponent.prototype, "FlattenedType", {
        get: /**
         * @return {?}
         */
        function () { return FlattenedType; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TocItemComponent.prototype, "MimeTypeMasterData", {
        get: /**
         * @return {?}
         */
        function () { return MimeTypeMasterData; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TocItemComponent.prototype, "ExpandBehavior", {
        get: /**
         * @return {?}
         */
        function () { return ExpandBehavior; },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    TocItemComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.setActiveContent();
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    TocItemComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        if (changes.activeMimeTypeFilter) {
            this.isMimeTypeFilterChanged = false;
            this.resetActiveContent = true;
        }
        else if (changes.tocData) {
            this.setActiveContent();
        }
        else if (changes.selectAll) {
            this.selectAllItems(this.selectAll);
        }
    };
    /**
     * @return {?}
     */
    TocItemComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var subscription = this.accordionItems.changes.subscribe((/**
         * @param {?} change
         * @return {?}
         */
        function (change) {
            if (_this.resetActiveContent && _this.accordionItems.length && _this.accordianConfig.expandBehavior === ExpandBehavior.EXPAND_FIRST) {
                _this.resetActiveContent = false;
                _this.accordionItems.first.collapsed = false;
                _this.collapsedChangeHandler(false, _this.accordionItems.first);
            }
        }));
        this.subscriptions.push(subscription);
    };
    /**
     * @return {?}
     */
    TocItemComponent.prototype.setActiveContent = /**
     * @return {?}
     */
    function () {
        if (this.tocData && this.tocData.children) {
            if ((this.tocData.children[0].contentData && this.tocData.children[0].contentData.trackable && this.tocData.children[0].contentData.trackable.enabled === 'Yes') ||
                (this.tocData.children[0].trackable && this.tocData.children[0].trackable.enabled === 'Yes')) {
                return;
            }
            /** @type {?} */
            var flattenDeepContents = this.flattenDeep(this.tocData.children);
            if (!this.activeContent) {
                this.activeContent = this.firstNonCollectionContent(flattenDeepContents);
            }
            if (!this.activeContent) {
                this.noContent.emit({ message: 'No Content Available' });
            }
        }
    };
    /**
     * @param {?} content
     * @return {?}
     */
    TocItemComponent.prototype.filterChildren = /**
     * @param {?} content
     * @return {?}
     */
    function (content) {
        // Check for the ActiveMimeType
        if (this.activeMimeTypeFilter.includes('all')) {
            if (content.mimeType === MimeTypeMasterData.COLLECTION) {
                return this.isShowContent(content, true);
            }
            return true; // Return true for all the content except collection mimeType
        }
        else if (content.mimeType && this.isSameMimeType(content)) {
            return true;
        }
        else if (content.mimeType === MimeTypeMasterData.COLLECTION) {
            return this.isShowContent(content, false);
        }
        else {
            return false;
        }
    };
    /**
     * @private
     * @param {?} content
     * @param {?} isActiveFilterAll
     * @return {?}
     */
    TocItemComponent.prototype.isShowContent = /**
     * @private
     * @param {?} content
     * @param {?} isActiveFilterAll
     * @return {?}
     */
    function (content, isActiveFilterAll) {
        var _this = this;
        if (content.mimeTypesCount && !isActiveFilterAll) {
            return this.isSameMimeTypeInChildren(content.mimeTypesCount, this.activeMimeTypeFilter);
        }
        else if (this.isChildrenPresent(content)) {
            /** @type {?} */
            var contentList = this.flattenDeep(content.children);
            return isActiveFilterAll ? contentList.some((/**
             * @param {?} c
             * @return {?}
             */
            function (c) { return c.mimeType !== MimeTypeMasterData.COLLECTION; })) :
                contentList.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return _this.isSameMimeType(c); }));
        }
        else {
            return false;
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    TocItemComponent.prototype.onTocCardClick = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        /** @type {?} */
        var rollup = this.getRollup(this.tocData, event.data.sbUniqueIdentifier);
        if (rollup.length) {
            rollup.pop();
        }
        this.tocCardClick.emit(tslib_1.__assign({}, event, { rollup: rollup }));
    };
    /**
     * @param {?} collapsed
     * @param {?} item
     * @return {?}
     */
    TocItemComponent.prototype.collapsedChangeHandler = /**
     * @param {?} collapsed
     * @param {?} item
     * @return {?}
     */
    function (collapsed, item) {
        if (this.accordianConfig.expandMode === ExpandMode.SINGLE && !collapsed) {
            this.accordionItems.filter((/**
             * @param {?} i
             * @return {?}
             */
            function (i) { return i !== item; })).forEach((/**
             * @param {?} i
             * @return {?}
             */
            function (i) {
                if (i.expanded) {
                    i.expanded = false;
                }
            }));
        }
    };
    /**
     * @private
     * @param {?} contents
     * @return {?}
     */
    TocItemComponent.prototype.firstNonCollectionContent = /**
     * @private
     * @param {?} contents
     * @return {?}
     */
    function (contents) {
        return contents.find((/**
         * @param {?} content
         * @return {?}
         */
        function (content) { return content.mimeType !== 'application/vnd.ekstep.content-collection'; }));
    };
    /**
     * @private
     * @param {?} contents
     * @return {?}
     */
    TocItemComponent.prototype.flattenDeep = /**
     * @private
     * @param {?} contents
     * @return {?}
     */
    function (contents) {
        var _this = this;
        if (contents) {
            return contents.reduce((/**
             * @param {?} acc
             * @param {?} val
             * @return {?}
             */
            function (acc, val) {
                if (val.children) {
                    acc.push(val);
                    return acc.concat(_this.flattenDeep(val.children));
                }
                else {
                    return acc.concat(val);
                }
            }), []);
        }
    };
    /**
     * @param {?} index
     * @param {?} item
     * @return {?}
     */
    TocItemComponent.prototype.isExpanded = /**
     * @param {?} index
     * @param {?} item
     * @return {?}
     */
    function (index, item) {
        var _this = this;
        /** @type {?} */
        var activeContent = item.children ? this.flattenDeep(item.children).find((/**
         * @param {?} child
         * @return {?}
         */
        function (child) {
            if (_this.activeContent && _this.activeContent.parent) {
                return child.identifier === _this.activeContent.identifier && child.parent === _this.activeContent.parent;
            }
            else {
                return child.identifier === _this.activeContent.identifier;
            }
        })) : undefined;
        return Boolean(activeContent || item && item.mimeType !== MimeTypeMasterData.COLLECTION);
    };
    /**
     * @param {?} item
     * @param {?} index
     * @return {?}
     */
    TocItemComponent.prototype.isShowBody = /**
     * @param {?} item
     * @param {?} index
     * @return {?}
     */
    function (item, index) {
        var _this = this;
        if (item) {
            /** @type {?} */
            var isShowAllMimeType = (/**
             * @return {?}
             */
            function () { return _this.activeMimeTypeFilter.indexOf('all') > -1; });
            /** @type {?} */
            var isCollection = (/**
             * @return {?}
             */
            function () { return item.mimeType === MimeTypeMasterData.COLLECTION; });
            /** @type {?} */
            var isMathchesMimeType = (/**
             * @return {?}
             */
            function () { return _this.activeMimeTypeFilter.indexOf(item.mimeType) > -1; });
            /** @type {?} */
            var isLastContent = (/**
             * @return {?}
             */
            function () { return _this.tocData.children.length === index + 1; });
            if (this.tocData && isShowAllMimeType() || (isCollection() || isMathchesMimeType())) {
                this.isMimeTypeFilterChanged = true;
                return true;
            }
            else if (this.activeMimeTypeFilter.indexOf(item.mimeType) < 0 && !isLastContent()) {
                return false;
            }
            else if (this.activeMimeTypeFilter.indexOf(item.mimeType) < 0 && isLastContent()) {
                if (this.isMimeTypeFilterChanged) {
                    return false;
                }
                this.isMimeTypeFilterChanged = false;
                return true;
            }
        }
        return false;
    };
    /**
     * @param {?} tree
     * @param {?} identifier
     * @return {?}
     */
    TocItemComponent.prototype.getRollup = /**
     * @param {?} tree
     * @param {?} identifier
     * @return {?}
     */
    function (tree, identifier) {
        /** @type {?} */
        var rollup = [tree.identifier];
        if (tree.sbUniqueIdentifier === identifier) {
            return rollup;
        }
        if (!tree.children || !tree.children.length) {
            return [];
        }
        /** @type {?} */
        var notDone = true;
        /** @type {?} */
        var childRollup;
        /** @type {?} */
        var index = 0;
        while (notDone && tree.children[index]) {
            childRollup = this.getRollup(tree.children[index], identifier);
            if (childRollup && childRollup.length) {
                notDone = false;
            }
            index++;
        }
        if (childRollup && childRollup.length) {
            rollup.push.apply(rollup, tslib_1.__spread(childRollup));
            return rollup;
        }
        else {
            return [];
        }
    };
    /**
     * @param {?} tocData
     * @param {?} item
     * @return {?}
     */
    TocItemComponent.prototype.createUniqueId = /**
     * @param {?} tocData
     * @param {?} item
     * @return {?}
     */
    function (tocData, item) {
        item['sbUniqueIdentifier'] = tocData.identifier + '_' + item.identifier;
    };
    /**
     * @since #SH-362
     * @param item - selected children data.
     * @description - It will despatch an event on individual checkbox click
     */
    /**
     * \@since #SH-362
     * \@description - It will despatch an event on individual checkbox click
     * @param {?} item - selected children data.
     * @return {?}
     */
    TocItemComponent.prototype.onItemSelect = /**
     * \@since #SH-362
     * \@description - It will despatch an event on individual checkbox click
     * @param {?} item - selected children data.
     * @return {?}
     */
    function (item) {
        this.selectedItem.emit({ data: item });
    };
    /**
     * @since #SH-362
     * @param isSelectAll - boolean, which will be true/false if 'Select all checkbox is checked/unchecked
     * @description - this method will mark every children of tocData object with an additional variable -
     *                selected: true/false based on the value of 'isSelectAll' and also despatch an event
     *                with the data.
     */
    /**
     * \@since #SH-362
     * \@description - this method will mark every children of tocData object with an additional variable -
     *                selected: true/false based on the value of 'isSelectAll' and also despatch an event
     *                with the data.
     * @param {?} isSelectAll - boolean, which will be true/false if 'Select all checkbox is checked/unchecked
     * @return {?}
     */
    TocItemComponent.prototype.selectAllItems = /**
     * \@since #SH-362
     * \@description - this method will mark every children of tocData object with an additional variable -
     *                selected: true/false based on the value of 'isSelectAll' and also despatch an event
     *                with the data.
     * @param {?} isSelectAll - boolean, which will be true/false if 'Select all checkbox is checked/unchecked
     * @return {?}
     */
    function (isSelectAll) {
        this.tocData['children'].forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            item.selected = isSelectAll;
        }));
        this.selectedItem.emit({ selectAll: isSelectAll, data: this.tocData['children'] });
    };
    /**
     * @param {?} event
     * @return {?}
     */
    TocItemComponent.prototype.onPlayButtonClick = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        /** @type {?} */
        var rollup = this.getRollup(this.tocData, event.data.sbUniqueIdentifier);
        if (rollup.length) {
            rollup.pop();
        }
        this.playButtonClick.emit(tslib_1.__assign({}, event, { rollup: rollup }));
    };
    /**
     * @param {?} content
     * @return {?}
     */
    TocItemComponent.prototype.isFlattenedType = /**
     * @param {?} content
     * @return {?}
     */
    function (content) {
        if (!(this.type === TocCardType.TRACKABLE) ||
            !((content.contentData && content.contentData.trackable && content.contentData.trackable.enabled === 'Yes') ||
                (content.trackable && content.trackable.enabled === 'Yes'))) {
            return FlattenedType.EXPAND;
        }
        else if (this.type === TocCardType.TRACKABLE &&
            ((content.contentData && content.contentData.trackable && content.contentData.trackable.enabled === 'Yes') ||
                (content.trackable && content.trackable.enabled === 'Yes'))) {
            return FlattenedType.COLLAPSE;
        }
        return '';
    };
    /**
     * @return {?}
     */
    TocItemComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        this.subscriptions.forEach((/**
         * @param {?} s
         * @return {?}
         */
        function (s) { return s.unsubscribe(); }));
    };
    TocItemComponent.decorators = [
        { type: Component, args: [{
                    selector: 'sb-toc-item',
                    template: "<div *ngFor=\"let item of tocData?.children; let index = index;\">\r\n  <ng-container *ngIf=\"(item | hasMimeType: activeMimeTypeFilter) || this.accordianConfig.expandBehavior === ExpandBehavior.NONE\">\r\n  <div *ngIf=\"item?.mimeType === MimeTypeMasterData?.COLLECTION && !(item?.contentData?.trackable?.enabled === 'Yes' || item?.trackable?.enabled === 'Yes')\">\r\n    <sb-accordion [multi]=\"false\" [id]=\"item.identifier\">\r\n      <sb-accordion-item #sbAccordionItem [expanded]=\"isExpanded(index, item)\" (collapsedChange)=\"collapsedChangeHandler($event, sbAccordionItem);\">\r\n        {{ createUniqueId(tocData, item) }}\r\n        <sb-accordion-header>\r\n            <div class=\"sb-checkbox sb-checkbox-primary\" *ngIf=\"selectMode\">\r\n                <input (change)=\"onItemSelect(item)\" [(ngModel)]=\"item.selected\" type=\"checkbox\" name=\"example\">\r\n                <label class=\"mb-0\"><span class=\"title font-weight-bold\">{{item?.name}}</span></label>\r\n            </div>\r\n            <span *ngIf=\"!selectMode\" class=\"title\">{{item?.name}}</span>\r\n        </sb-accordion-header>\r\n        <sb-accordion-body *ngIf=\"isShowBody(item, index)\">\r\n          <div *ngIf=\"item && (item | hasMimeType: activeMimeTypeFilter);else noContent\" #chapterContainer>\r\n            <ng-container *ngIf=\"item?.children?.length\">\r\n              <ng-container *ngFor=\"let child of item?.children; let j = index;\">\r\n                {{ createUniqueId(item, child) }}\r\n                <div class=\"sbchapter\"\r\n                  *ngIf=\"recogniseCollection && filterChildren(child) && child.item?.contentType === 'TextBook'\">\r\n                  <sb-my-course-card [type]=\"'recently_viewed'\"></sb-my-course-card>\r\n                </div>\r\n                <div class=\"sbchapter\"\r\n                  *ngIf=\"recogniseCollection && filterChildren(child) && child.item?.contentType === 'Course'\">\r\n                  <sb-my-course-card [type]=\"'recently_viewed'\"></sb-my-course-card>\r\n                </div>\r\n                <div class=\"sbchapter\" *ngIf=\"filterChildren(child)\" [id]=\"child.identifier\">\r\n                  <ng-container *ngIf=\"isFlattenedType(child) === FlattenedType.EXPAND\">\r\n                    <sb-toc-child-item *ngIf=\"type\" [type]=\"type\" [contentStatus]=\"contentStatus\" [childData]=\"child\"\r\n                      [activeMimeTypeFilter]=\"activeMimeTypeFilter\" [activeContent]=\"activeContent\" [platform]=\"platform\"\r\n                      (tocCardClick)=\"onTocCardClick($event)\" [playBtnConfig]=\"playBtnConfig\" (playButtonClick)=\"onPlayButtonClick($event)\"\r\n                      [trackableDefaultImage]=\"trackableDefaultImage\">\r\n                    </sb-toc-child-item>\r\n                    <sb-toc-child-item *ngIf=\"!type\" [childData]=\"child\" [activeMimeTypeFilter]=\"activeMimeTypeFilter\"\r\n                      [activeContent]=\"activeContent\" (tocCardClick)=\"onTocCardClick($event)\" [playBtnConfig]=\"playBtnConfig\"\r\n                      (playButtonClick)=\"onPlayButtonClick($event)\" [platform]=\"platform\" [trackableDefaultImage]=\"trackableDefaultImage\">\r\n                    </sb-toc-child-item>\r\n                  </ng-container>\r\n\r\n                  <ng-container *ngIf=\"isFlattenedType(child) === FlattenedType.COLLAPSE\">\r\n                    <sb-toc-card *ngIf=\"type\" [type]=\"type\" [content]=\"child\" (tocCardClick)=\"onTocCardClick($event)\"\r\n                      [activeContent]=\"activeContent\" [playBtnConfig]=\"playBtnConfig\" (playButtonClick)=\"onPlayButtonClick($event)\"\r\n                      [trackableDefaultImage]=\"trackableDefaultImage\" [platform]=\"platform\">\r\n                    </sb-toc-card>\r\n                    <sb-toc-card *ngIf=\"!type\" [content]=\"child\" (tocCardClick)=\"onTocCardClick($event)\"\r\n                      [activeContent]=\"activeContent\" [playBtnConfig]=\"playBtnConfig\" (playButtonClick)=\"onPlayButtonClick($event)\"\r\n                      [trackableDefaultImage]=\"trackableDefaultImage\" [platform]=\"platform\">\r\n                    </sb-toc-card>\r\n                  </ng-container>\r\n\r\n                </div>\r\n              </ng-container>\r\n            </ng-container>\r\n            <ng-container *ngIf=\"item?.mimeType === MimeTypeMasterData?.COLLECTION && !item?.children?.length\">\r\n              <div class=\"heading\">{{noContentMessage}}</div>\r\n            </ng-container>\r\n          </div>\r\n          <ng-template #noContent>\r\n            <div class=\"heading\">{{noContentMessage}}</div>\r\n          </ng-template>\r\n        </sb-accordion-body>\r\n      </sb-accordion-item>\r\n    </sb-accordion>\r\n  </div>\r\n  <div *ngIf=\"(item?.mimeType !== MimeTypeMasterData?.COLLECTION && !item?.children?.length) ||\r\n    item?.contentData?.trackable?.enabled === 'Yes' || item?.trackable?.enabled === 'Yes'\" class=\"sb-content__bar\">\r\n    <ng-container>\r\n    <div class=\"child-content-padding\">\r\n      <sb-toc-card *ngIf=\"type\" [type]=\"type\" [contentStatus]=\"contentStatus\" [content]=\"item\"\r\n        (tocCardClick)=\"onTocCardClick($event)\" [activeContent]=\"activeContent\" [playBtnConfig]=\"playBtnConfig\"\r\n        (playButtonClick)=\"onPlayButtonClick($event)\" [platform]=\"platform\" [trackableDefaultImage]=\"trackableDefaultImage\">\r\n      </sb-toc-card>\r\n      <sb-toc-card *ngIf=\"!type\" [content]=\"item\" (tocCardClick)=\"onTocCardClick($event)\" [platform]=\"platform\"\r\n        [activeContent]=\"activeContent\" [playBtnConfig]=\"playBtnConfig\" (playButtonClick)=\"onPlayButtonClick($event)\"\r\n        [trackableDefaultImage]=\"trackableDefaultImage\">\r\n      </sb-toc-card>\r\n    </div>\r\n    </ng-container>\r\n  </div>\r\n  </ng-container>\r\n</div>\r\n",
                    providers: [MimeTypePipe],
                    styles: [".sbchapter{border-bottom:.0625rem solid var(--gray-100);padding:0 0 1rem;margin-bottom:1rem}.sbchapter:last-child{border-bottom:0;margin-bottom:0;padding-bottom:0}.sbchapter h4{font-size:.625rem;line-height:1.125rem;color:var(--gray-800);margin-bottom:.5rem}.sbchapter__item{background:var(--white);box-shadow:0 .1875rem .25rem 0 rgba(var(--rc-rgba-primary),.1);border:.03125rem solid rgba(var(--rc-rgba-primary),.5);display:flex;align-items:center;justify-content:space-between;margin-bottom:.5rem;padding:.5rem;cursor:pointer;min-height:3.5rem}.sbchapter__item h4{font-size:.75rem;line-height:1.25rem;color:var(--primary-400);margin:0;padding:0}.sbchapter__item .sbchapter__img{width:1.5rem;height:1.5rem;flex:0 0 1.5rem}.sbchapter__item .sbchapter__img img{width:100%}.sbchapter__item .sbchapter__img .icon-svg svg.icon .icon-svg--primary{fill:#9cb9ff}.sbchapter__item:hover{background:var(--gray-0)}.sbchapter__item--active,.sbchapter__item--active:hover{background:var(--primary-100)}.sbchapter-open{border-bottom:.0625rem solid #e0e0e0;padding-bottom:var(--base-block-space)}.sbchapter-open__title{font-size:.875rem;font-weight:700;color:var(--primary-400);margin:0;padding:1rem;width:100%}.sbchapter-open__topics{padding:0}.sbchapter-open__topics__title{font-size:.875rem;line-height:1.375rem;margin:0 0 .5rem;color:var(--primary-400);padding:0 1rem}.sbchapter-open__topic{font-size:.75rem;line-height:1.25rem;padding:8px 2rem;margin:0;color:var(--primary-400)}.sbchapter-open__topic--active{background:var(--primary-100)}.sbchapter-open__topic:hover{background:var(--gray-0)}.sbsmartscroll-style::-webkit-scrollbar{width:.3125rem;height:.3125rem;background-color:var(--primary-400);-webkit-appearance:none}.sbsmartscroll-style::-webkit-scrollbar-thumb{background-color:var(--gray-400)}.sbsmartscroll-style::-webkit-scrollbar-track{-webkit-box-shadow:inset 0 0 .375rem rgba(var(--rc-rgba-black),0);background-color:var(--gray-0)}.heading{font-size:.875rem;line-height:1.375rem;font-weight:700;text-align:center;color:var(--gray-400);padding:1rem}.child-content-padding{padding:0}.sb-content__bar{margin:.5rem 0;background:var(--gray-0)}"]
                }] }
    ];
    /** @nocollapse */
    TocItemComponent.ctorParameters = function () { return []; };
    TocItemComponent.propDecorators = {
        accordianConfig: [{ type: Input }],
        accordionItems: [{ type: ViewChildren, args: ['sbAccordionItem',] }],
        tocData: [{ type: Input }],
        activeMimeTypeFilter: [{ type: Input }],
        noContentMessage: [{ type: Input }],
        contentStatus: [{ type: Input }],
        selectMode: [{ type: Input }],
        selectAll: [{ type: Input }],
        playBtnConfig: [{ type: Input }],
        platform: [{ type: Input }],
        trackableDefaultImage: [{ type: Input }],
        divs: [{ type: ViewChild, args: ['chapter', { static: false },] }],
        chapterContainer: [{ type: ViewChildren, args: ['chapterContainer',] }],
        type: [{ type: Input }],
        activeContent: [{ type: Input }],
        recogniseCollection: [{ type: Input }],
        tocCardClick: [{ type: Output }],
        noContent: [{ type: Output }],
        selectedItem: [{ type: Output }],
        playButtonClick: [{ type: Output }]
    };
    return TocItemComponent;
}());
export { TocItemComponent };
if (false) {
    /** @type {?} */
    TocItemComponent.prototype.accordianConfig;
    /** @type {?} */
    TocItemComponent.prototype.accordionItems;
    /** @type {?} */
    TocItemComponent.prototype.tocData;
    /** @type {?} */
    TocItemComponent.prototype.activeMimeTypeFilter;
    /** @type {?} */
    TocItemComponent.prototype.noContentMessage;
    /** @type {?} */
    TocItemComponent.prototype.contentStatus;
    /** @type {?} */
    TocItemComponent.prototype.selectMode;
    /** @type {?} */
    TocItemComponent.prototype.selectAll;
    /** @type {?} */
    TocItemComponent.prototype.playBtnConfig;
    /** @type {?} */
    TocItemComponent.prototype.platform;
    /** @type {?} */
    TocItemComponent.prototype.trackableDefaultImage;
    /** @type {?} */
    TocItemComponent.prototype.divs;
    /** @type {?} */
    TocItemComponent.prototype.chapterContainer;
    /** @type {?} */
    TocItemComponent.prototype.type;
    /** @type {?} */
    TocItemComponent.prototype.activeContent;
    /** @type {?} */
    TocItemComponent.prototype.recogniseCollection;
    /** @type {?} */
    TocItemComponent.prototype.tocCardClick;
    /** @type {?} */
    TocItemComponent.prototype.noContent;
    /** @type {?} */
    TocItemComponent.prototype.selectedItem;
    /** @type {?} */
    TocItemComponent.prototype.playButtonClick;
    /**
     * @type {?}
     * @private
     */
    TocItemComponent.prototype.resetActiveContent;
    /** @type {?} */
    TocItemComponent.prototype.isMimeTypeFilterChanged;
    /**
     * @type {?}
     * @private
     */
    TocItemComponent.prototype.isSameMimeTypeInChildren;
    /**
     * @type {?}
     * @private
     */
    TocItemComponent.prototype.isSameMimeType;
    /**
     * @type {?}
     * @private
     */
    TocItemComponent.prototype.isChildrenPresent;
    /**
     * @type {?}
     * @private
     */
    TocItemComponent.prototype.subscriptions;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidG9jLWl0ZW0uY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQHByb2plY3Qtc3VuYmlyZC9jb21tb24tY29uc3VtcHRpb24tdjgvIiwic291cmNlcyI6WyJsaWIvY29udGVudC1kZXRhaWxzL3RvYy1pdGVtL3RvYy1pdGVtLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFDTCxTQUFTLEVBQVUsS0FBSyxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQUUsU0FBUyxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQ25GLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBRSxjQUFjLEVBQUUsVUFBVSxFQUFFLGFBQWEsRUFBb0IsV0FBVyxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDN0csT0FBTyxFQUFFLFlBQVksRUFBRSxrQkFBa0IsRUFBRSxNQUFNLDhCQUE4QixDQUFDO0FBR2hGO0lBNENFO1FBQUEsaUJBQWlCO1FBckNSLG9CQUFlLEdBQXFCO1lBQzNDLFVBQVUsRUFBRSxVQUFVLENBQUMsUUFBUTtZQUMvQixjQUFjLEVBQUUsY0FBYyxDQUFDLElBQUk7U0FDcEMsQ0FBQztRQUdPLHlCQUFvQixHQUFHLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDL0IscUJBQWdCLEdBQUcsc0JBQXNCLENBQUM7UUFDMUMsa0JBQWEsR0FBRyxFQUFFLENBQUM7UUFLbkIsMEJBQXFCLEdBQUcsRUFBRSxDQUFDO1FBSTNCLFNBQUksR0FBRyxFQUFFLENBQUM7UUFHVix3QkFBbUIsR0FBRyxLQUFLLENBQUM7UUFDM0IsaUJBQVksR0FBc0IsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUNyRCxjQUFTLEdBQXNCLElBQUksWUFBWSxFQUFFLENBQUM7UUFDbEQsaUJBQVksR0FBc0IsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUNyRCxvQkFBZSxHQUFzQixJQUFJLFlBQVksRUFBRSxDQUFDO1FBQzFELHVCQUFrQixHQUFHLEtBQUssQ0FBQztRQUlu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QWdCOzs7SUFDM0IsMkNBR0U7O0lBQ0YsMENBQW1GOztJQUNuRixtQ0FBaUI7O0lBQ2pCLGdEQUF3Qzs7SUFDeEMsNENBQW1EOztJQUNuRCx5Q0FBNEI7O0lBQzVCLHNDQUFvQjs7SUFDcEIscUNBQW1COztJQUNuQix5Q0FBdUI7O0lBQ3ZCLG9DQUFrQjs7SUFDbEIsaURBQW9DOztJQUNwQyxnQ0FBMkQ7O0lBQzNELDRDQUFtRTs7SUFFbkUsZ0NBQW1COztJQUVuQix5Q0FBdUI7O0lBQ3ZCLCtDQUFxQzs7SUFDckMsd0NBQStEOztJQUMvRCxxQ0FBNEQ7O0lBQzVELHdDQUErRDs7SUFDL0QsMkNBQWtFOzs7OztJQUNsRSw4Q0FBbUM7O0lBSW5DLG1EQUFnQzs7Ozs7SUFDaEMsb0RBR0c7Ozs7O0lBQ0gsMENBQThIOzs7OztJQUM5SCw2Q0FBbUg7Ozs7O0lBQ25ILHlDQUEyQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XHJcbiAgQ29tcG9uZW50LCBPbkluaXQsIElucHV0LCBPdXRwdXQsIEV2ZW50RW1pdHRlciwgVmlld0NoaWxkLCBRdWVyeUxpc3QsIFZpZXdDaGlsZHJlbiwgT25DaGFuZ2VzLCBBZnRlclZpZXdJbml0LCBPbkRlc3Ryb3lcclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgRXhwYW5kQmVoYXZpb3IsIEV4cGFuZE1vZGUsIEZsYXR0ZW5lZFR5cGUsIElBY2NvcmRpYW5Db25maWcsIFRvY0NhcmRUeXBlIH0gZnJvbSAnLi4vLi4vY2FyZC9tb2RlbHMnO1xyXG5pbXBvcnQgeyBNaW1lVHlwZVBpcGUsIE1pbWVUeXBlTWFzdGVyRGF0YSB9IGZyb20gJy4uLy4uL3BpcGVzLW1vZHVsZS9taW1lLXR5cGUnO1xyXG5pbXBvcnQge0FjY29yZGlvbkl0ZW1Db21wb25lbnR9IGZyb20gJy4uLy4uL2FjY29yZGlvbi9hY2NvcmRpb24taXRlbS9hY2NvcmRpb24taXRlbS5jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzJztcclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdzYi10b2MtaXRlbScsXHJcbiAgdGVtcGxhdGVVcmw6ICcuL3RvYy1pdGVtLmNvbXBvbmVudC5odG1sJyxcclxuICBzdHlsZVVybHM6IFsnLi90b2MtaXRlbS5jb21wb25lbnQuc2NzcyddLFxyXG4gIHByb3ZpZGVyczogW01pbWVUeXBlUGlwZV1cclxufSlcclxuZXhwb3J0IGNsYXNzIFRvY0l0ZW1Db21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uQ2hhbmdlcywgQWZ0ZXJWaWV3SW5pdCwgT25EZXN0cm95IHtcclxuICBASW5wdXQoKSBhY2NvcmRpYW5Db25maWc6IElBY2NvcmRpYW5Db25maWcgPSB7XHJcbiAgICBleHBhbmRNb2RlOiBFeHBhbmRNb2RlLk1VTFRJUExFLFxyXG4gICAgZXhwYW5kQmVoYXZpb3I6IEV4cGFuZEJlaGF2aW9yLk5PTkVcclxuICB9O1xyXG4gIEBWaWV3Q2hpbGRyZW4oJ3NiQWNjb3JkaW9uSXRlbScpIGFjY29yZGlvbkl0ZW1zOiBRdWVyeUxpc3Q8QWNjb3JkaW9uSXRlbUNvbXBvbmVudD47XHJcbiAgQElucHV0KCkgdG9jRGF0YTtcclxuICBASW5wdXQoKSBhY3RpdmVNaW1lVHlwZUZpbHRlciA9IFsnYWxsJ107XHJcbiAgQElucHV0KCkgbm9Db250ZW50TWVzc2FnZSA9ICdObyBjb250ZW50IGF2YWlsYWJsZSc7XHJcbiAgQElucHV0KCkgY29udGVudFN0YXR1cyA9IFtdO1xyXG4gIEBJbnB1dCgpIHNlbGVjdE1vZGU7XHJcbiAgQElucHV0KCkgc2VsZWN0QWxsO1xyXG4gIEBJbnB1dCgpIHBsYXlCdG5Db25maWc7XHJcbiAgQElucHV0KCkgcGxhdGZvcm07XHJcbiAgQElucHV0KCkgdHJhY2thYmxlRGVmYXVsdEltYWdlID0gJyc7XHJcbiAgQFZpZXdDaGlsZCgnY2hhcHRlcicse3N0YXRpYzogZmFsc2V9KSBkaXZzOiBRdWVyeUxpc3Q8YW55PjtcclxuICBAVmlld0NoaWxkcmVuKCdjaGFwdGVyQ29udGFpbmVyJykgY2hhcHRlckNvbnRhaW5lcjogUXVlcnlMaXN0PGFueT47XHJcblxyXG4gIEBJbnB1dCgpIHR5cGUgPSBcIlwiO1xyXG5cclxuICBASW5wdXQoKSBhY3RpdmVDb250ZW50O1xyXG4gIEBJbnB1dCgpIHJlY29nbmlzZUNvbGxlY3Rpb24gPSBmYWxzZTtcclxuICBAT3V0cHV0KCkgdG9jQ2FyZENsaWNrOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICBAT3V0cHV0KCkgbm9Db250ZW50OiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICBAT3V0cHV0KCkgc2VsZWN0ZWRJdGVtOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICBAT3V0cHV0KCkgcGxheUJ1dHRvbkNsaWNrOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICBwcml2YXRlIHJlc2V0QWN0aXZlQ29udGVudCA9IGZhbHNlO1xyXG4gIGdldCBGbGF0dGVuZWRUeXBlKCkgeyByZXR1cm4gRmxhdHRlbmVkVHlwZTsgfVxyXG4gIGdldCBNaW1lVHlwZU1hc3RlckRhdGEoKSB7IHJldHVybiBNaW1lVHlwZU1hc3RlckRhdGE7IH1cclxuICBnZXQgRXhwYW5kQmVoYXZpb3IoKSB7IHJldHVybiBFeHBhbmRCZWhhdmlvcjsgfVxyXG4gIGlzTWltZVR5cGVGaWx0ZXJDaGFuZ2VkID0gZmFsc2U7XHJcbiAgcHJpdmF0ZSBpc1NhbWVNaW1lVHlwZUluQ2hpbGRyZW4gPSAoKG1pbWVUeXBlc0NvdW50LCBhY3RpdmVNaW1lVHlwZSkgPT4ge1xyXG4gICAgY29uc3QgY29udGVudE1pbWVUeXBlID0gT2JqZWN0LmtleXMoSlNPTi5wYXJzZShtaW1lVHlwZXNDb3VudCkpO1xyXG4gICAgcmV0dXJuIEJvb2xlYW4oYWN0aXZlTWltZVR5cGUuZmlsdGVyKHZhbHVlID0+IGNvbnRlbnRNaW1lVHlwZS5pbmNsdWRlcyh2YWx1ZSkpLmxlbmd0aCk7XHJcbiAgfSk7XHJcbiAgcHJpdmF0ZSBpc1NhbWVNaW1lVHlwZSA9IChjdXJyZW50Q29udGVudCkgPT4gdGhpcy5hY3RpdmVNaW1lVHlwZUZpbHRlci5maW5kKG1pbWVUeXBlID0+IG1pbWVUeXBlID09PSBjdXJyZW50Q29udGVudC5taW1lVHlwZSk7XHJcbiAgcHJpdmF0ZSBpc0NoaWxkcmVuUHJlc2VudCA9IChjdXJyZW50Q29udGVudCkgPT4gQm9vbGVhbihjdXJyZW50Q29udGVudC5jaGlsZHJlbiAmJiBjdXJyZW50Q29udGVudC5jaGlsZHJlbi5sZW5ndGgpO1xyXG4gIHByaXZhdGUgc3Vic2NyaXB0aW9uczogU3Vic2NyaXB0aW9uW10gPSBbXTtcclxuICBjb25zdHJ1Y3RvcigpIHsgfVxyXG5cclxuICBuZ09uSW5pdCgpIHtcclxuICAgIHRoaXMuc2V0QWN0aXZlQ29udGVudCgpO1xyXG4gIH1cclxuXHJcbiAgbmdPbkNoYW5nZXMoY2hhbmdlcykge1xyXG4gICAgaWYgKGNoYW5nZXMuYWN0aXZlTWltZVR5cGVGaWx0ZXIpIHtcclxuICAgICAgdGhpcy5pc01pbWVUeXBlRmlsdGVyQ2hhbmdlZCA9IGZhbHNlO1xyXG4gICAgICB0aGlzLnJlc2V0QWN0aXZlQ29udGVudCA9IHRydWU7XHJcbiAgICB9IGVsc2UgaWYgKGNoYW5nZXMudG9jRGF0YSkge1xyXG4gICAgICB0aGlzLnNldEFjdGl2ZUNvbnRlbnQoKTtcclxuICAgIH0gZWxzZSBpZiAoY2hhbmdlcy5zZWxlY3RBbGwpIHtcclxuICAgICAgdGhpcy5zZWxlY3RBbGxJdGVtcyh0aGlzLnNlbGVjdEFsbCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBuZ0FmdGVyVmlld0luaXQoKSB7XHJcbiAgICBjb25zdCBzdWJzY3JpcHRpb24gPSAgdGhpcy5hY2NvcmRpb25JdGVtcy5jaGFuZ2VzLnN1YnNjcmliZShjaGFuZ2UgPT4ge1xyXG4gICAgICBpZiAodGhpcy5yZXNldEFjdGl2ZUNvbnRlbnQgJiYgdGhpcy5hY2NvcmRpb25JdGVtcy5sZW5ndGggJiYgdGhpcy5hY2NvcmRpYW5Db25maWcuZXhwYW5kQmVoYXZpb3IgPT09IEV4cGFuZEJlaGF2aW9yLkVYUEFORF9GSVJTVCkge1xyXG4gICAgICAgIHRoaXMucmVzZXRBY3RpdmVDb250ZW50ID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5hY2NvcmRpb25JdGVtcy5maXJzdC5jb2xsYXBzZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmNvbGxhcHNlZENoYW5nZUhhbmRsZXIoZmFsc2UsIHRoaXMuYWNjb3JkaW9uSXRlbXMuZmlyc3QpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5wdXNoKHN1YnNjcmlwdGlvbik7XHJcbiAgfVxyXG5cclxuICBzZXRBY3RpdmVDb250ZW50KCkge1xyXG4gICAgaWYgKHRoaXMudG9jRGF0YSAmJiB0aGlzLnRvY0RhdGEuY2hpbGRyZW4pIHtcclxuICAgICAgaWYgKCh0aGlzLnRvY0RhdGEuY2hpbGRyZW5bMF0uY29udGVudERhdGEgJiYgdGhpcy50b2NEYXRhLmNoaWxkcmVuWzBdLmNvbnRlbnREYXRhLnRyYWNrYWJsZSAmJiB0aGlzLnRvY0RhdGEuY2hpbGRyZW5bMF0uY29udGVudERhdGEudHJhY2thYmxlLmVuYWJsZWQgPT09ICdZZXMnKSB8fFxyXG4gICAgICAgICh0aGlzLnRvY0RhdGEuY2hpbGRyZW5bMF0udHJhY2thYmxlICYmIHRoaXMudG9jRGF0YS5jaGlsZHJlblswXS50cmFja2FibGUuZW5hYmxlZCA9PT0gJ1llcycpKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIGNvbnN0IGZsYXR0ZW5EZWVwQ29udGVudHMgPSB0aGlzLmZsYXR0ZW5EZWVwKHRoaXMudG9jRGF0YS5jaGlsZHJlbik7XHJcbiAgICAgIGlmICghdGhpcy5hY3RpdmVDb250ZW50KSB7XHJcbiAgICAgICAgdGhpcy5hY3RpdmVDb250ZW50ID0gdGhpcy5maXJzdE5vbkNvbGxlY3Rpb25Db250ZW50KGZsYXR0ZW5EZWVwQ29udGVudHMpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICghdGhpcy5hY3RpdmVDb250ZW50KSB7XHJcbiAgICAgICAgdGhpcy5ub0NvbnRlbnQuZW1pdCh7IG1lc3NhZ2U6ICdObyBDb250ZW50IEF2YWlsYWJsZScgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHB1YmxpYyBmaWx0ZXJDaGlsZHJlbihjb250ZW50KSB7XHJcbiAgICAvLyBDaGVjayBmb3IgdGhlIEFjdGl2ZU1pbWVUeXBlXHJcbiAgICBpZiAodGhpcy5hY3RpdmVNaW1lVHlwZUZpbHRlci5pbmNsdWRlcygnYWxsJykpIHtcclxuICAgICAgaWYgKGNvbnRlbnQubWltZVR5cGUgPT09IE1pbWVUeXBlTWFzdGVyRGF0YS5DT0xMRUNUSU9OKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaXNTaG93Q29udGVudChjb250ZW50LCB0cnVlKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gdHJ1ZTsgLy8gUmV0dXJuIHRydWUgZm9yIGFsbCB0aGUgY29udGVudCBleGNlcHQgY29sbGVjdGlvbiBtaW1lVHlwZVxyXG4gICAgfSBlbHNlIGlmIChjb250ZW50Lm1pbWVUeXBlICYmIHRoaXMuaXNTYW1lTWltZVR5cGUoY29udGVudCkpIHtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9IGVsc2UgaWYgKGNvbnRlbnQubWltZVR5cGUgPT09IE1pbWVUeXBlTWFzdGVyRGF0YS5DT0xMRUNUSU9OKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmlzU2hvd0NvbnRlbnQoY29udGVudCwgZmFsc2UpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBpc1Nob3dDb250ZW50KGNvbnRlbnQsIGlzQWN0aXZlRmlsdGVyQWxsKSB7XHJcbiAgICBpZiAoY29udGVudC5taW1lVHlwZXNDb3VudCAmJiAhaXNBY3RpdmVGaWx0ZXJBbGwpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuaXNTYW1lTWltZVR5cGVJbkNoaWxkcmVuKGNvbnRlbnQubWltZVR5cGVzQ291bnQsIHRoaXMuYWN0aXZlTWltZVR5cGVGaWx0ZXIpO1xyXG4gICAgfSBlbHNlIGlmICh0aGlzLmlzQ2hpbGRyZW5QcmVzZW50KGNvbnRlbnQpKSB7XHJcbiAgICAgIGNvbnN0IGNvbnRlbnRMaXN0ID0gdGhpcy5mbGF0dGVuRGVlcChjb250ZW50LmNoaWxkcmVuKTtcclxuICAgICAgcmV0dXJuIGlzQWN0aXZlRmlsdGVyQWxsID8gY29udGVudExpc3Quc29tZSgoYykgPT4gYy5taW1lVHlwZSAhPT0gTWltZVR5cGVNYXN0ZXJEYXRhLkNPTExFQ1RJT04pIDpcclxuICAgICAgICBjb250ZW50TGlzdC5zb21lKChjKSA9PiB0aGlzLmlzU2FtZU1pbWVUeXBlKGMpKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHB1YmxpYyBvblRvY0NhcmRDbGljayhldmVudCkge1xyXG4gICAgY29uc3Qgcm9sbHVwID0gdGhpcy5nZXRSb2xsdXAodGhpcy50b2NEYXRhLCBldmVudC5kYXRhLnNiVW5pcXVlSWRlbnRpZmllcik7XHJcbiAgICBpZiAocm9sbHVwLmxlbmd0aCkge1xyXG4gICAgICByb2xsdXAucG9wKCk7XHJcbiAgICB9XHJcbiAgICB0aGlzLnRvY0NhcmRDbGljay5lbWl0KHsgLi4uZXZlbnQsIHJvbGx1cCB9KTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBjb2xsYXBzZWRDaGFuZ2VIYW5kbGVyKGNvbGxhcHNlZDogYm9vbGVhbiwgaXRlbTogQWNjb3JkaW9uSXRlbUNvbXBvbmVudCkge1xyXG4gICAgaWYgKHRoaXMuYWNjb3JkaWFuQ29uZmlnLmV4cGFuZE1vZGUgPT09IEV4cGFuZE1vZGUuU0lOR0xFICYmICFjb2xsYXBzZWQpIHtcclxuICAgICAgdGhpcy5hY2NvcmRpb25JdGVtcy5maWx0ZXIoaSA9PiBpICE9PSBpdGVtKS5mb3JFYWNoKChpKSA9PiB7XHJcbiAgICAgICAgaWYgKGkuZXhwYW5kZWQpIHsgaS5leHBhbmRlZCA9IGZhbHNlOyB9XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBmaXJzdE5vbkNvbGxlY3Rpb25Db250ZW50KGNvbnRlbnRzKSB7XHJcbiAgICByZXR1cm4gY29udGVudHMuZmluZCgoY29udGVudCkgPT4gY29udGVudC5taW1lVHlwZSAhPT0gJ2FwcGxpY2F0aW9uL3ZuZC5la3N0ZXAuY29udGVudC1jb2xsZWN0aW9uJyk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGZsYXR0ZW5EZWVwKGNvbnRlbnRzKSB7XHJcbiAgICBpZiAoY29udGVudHMpIHtcclxuICAgICAgcmV0dXJuIGNvbnRlbnRzLnJlZHVjZSgoYWNjLCB2YWwpID0+IHtcclxuICAgICAgICBpZiAodmFsLmNoaWxkcmVuKSB7XHJcbiAgICAgICAgICBhY2MucHVzaCh2YWwpO1xyXG4gICAgICAgICAgcmV0dXJuIGFjYy5jb25jYXQodGhpcy5mbGF0dGVuRGVlcCh2YWwuY2hpbGRyZW4pKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmV0dXJuIGFjYy5jb25jYXQodmFsKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0sIFtdKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGlzRXhwYW5kZWQoaW5kZXg6IG51bWJlciwgaXRlbSkge1xyXG4gICAgY29uc3QgYWN0aXZlQ29udGVudCA9IGl0ZW0uY2hpbGRyZW4gPyB0aGlzLmZsYXR0ZW5EZWVwKGl0ZW0uY2hpbGRyZW4pLmZpbmQoKGNoaWxkKSA9PiB7XHJcbiAgICAgIGlmICh0aGlzLmFjdGl2ZUNvbnRlbnQgJiYgdGhpcy5hY3RpdmVDb250ZW50LnBhcmVudCkge1xyXG4gICAgICAgIHJldHVybiBjaGlsZC5pZGVudGlmaWVyID09PSB0aGlzLmFjdGl2ZUNvbnRlbnQuaWRlbnRpZmllciAmJiBjaGlsZC5wYXJlbnQgPT09IHRoaXMuYWN0aXZlQ29udGVudC5wYXJlbnQ7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIGNoaWxkLmlkZW50aWZpZXIgPT09IHRoaXMuYWN0aXZlQ29udGVudC5pZGVudGlmaWVyO1xyXG4gICAgICB9XHJcbiAgICB9KSA6IHVuZGVmaW5lZDtcclxuICAgIHJldHVybiBCb29sZWFuKGFjdGl2ZUNvbnRlbnQgfHwgaXRlbSAmJiBpdGVtLm1pbWVUeXBlICE9PSBNaW1lVHlwZU1hc3RlckRhdGEuQ09MTEVDVElPTik7XHJcbiAgfVxyXG5cclxuICBpc1Nob3dCb2R5KGl0ZW0sIGluZGV4KSB7XHJcbiAgICBpZiAoaXRlbSkge1xyXG4gICAgICBjb25zdCBpc1Nob3dBbGxNaW1lVHlwZSA9ICgpID0+IHRoaXMuYWN0aXZlTWltZVR5cGVGaWx0ZXIuaW5kZXhPZignYWxsJykgPiAtMTtcclxuICAgICAgY29uc3QgaXNDb2xsZWN0aW9uID0gKCkgPT4gaXRlbS5taW1lVHlwZSA9PT0gTWltZVR5cGVNYXN0ZXJEYXRhLkNPTExFQ1RJT047XHJcbiAgICAgIGNvbnN0IGlzTWF0aGNoZXNNaW1lVHlwZSA9ICgpID0+IHRoaXMuYWN0aXZlTWltZVR5cGVGaWx0ZXIuaW5kZXhPZihpdGVtLm1pbWVUeXBlKSA+IC0xO1xyXG4gICAgICBjb25zdCBpc0xhc3RDb250ZW50ID0gKCkgPT4gdGhpcy50b2NEYXRhLmNoaWxkcmVuLmxlbmd0aCA9PT0gaW5kZXggKyAxO1xyXG5cclxuICAgICAgaWYgKHRoaXMudG9jRGF0YSAmJiBpc1Nob3dBbGxNaW1lVHlwZSgpIHx8IChpc0NvbGxlY3Rpb24oKSB8fCBpc01hdGhjaGVzTWltZVR5cGUoKSkpIHtcclxuICAgICAgICB0aGlzLmlzTWltZVR5cGVGaWx0ZXJDaGFuZ2VkID0gdHJ1ZTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfSBlbHNlIGlmICh0aGlzLmFjdGl2ZU1pbWVUeXBlRmlsdGVyLmluZGV4T2YoaXRlbS5taW1lVHlwZSkgPCAwICYmICFpc0xhc3RDb250ZW50KCkpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5hY3RpdmVNaW1lVHlwZUZpbHRlci5pbmRleE9mKGl0ZW0ubWltZVR5cGUpIDwgMCAmJiBpc0xhc3RDb250ZW50KCkpIHtcclxuICAgICAgICBpZiAodGhpcy5pc01pbWVUeXBlRmlsdGVyQ2hhbmdlZCkge1xyXG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmlzTWltZVR5cGVGaWx0ZXJDaGFuZ2VkID0gZmFsc2U7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG5cclxuICBnZXRSb2xsdXAodHJlZSwgaWRlbnRpZmllcikge1xyXG4gICAgbGV0IHJvbGx1cCA9IFt0cmVlLmlkZW50aWZpZXJdO1xyXG4gICAgaWYgKHRyZWUuc2JVbmlxdWVJZGVudGlmaWVyID09PSBpZGVudGlmaWVyKSB7XHJcbiAgICAgIHJldHVybiByb2xsdXA7XHJcbiAgICB9XHJcbiAgICBpZiAoIXRyZWUuY2hpbGRyZW4gfHwgIXRyZWUuY2hpbGRyZW4ubGVuZ3RoKSB7XHJcbiAgICAgIHJldHVybiBbXTtcclxuICAgIH1cclxuICAgIGxldCBub3REb25lID0gdHJ1ZTtcclxuICAgIGxldCBjaGlsZFJvbGx1cDogYW55O1xyXG4gICAgbGV0IGluZGV4ID0gMDtcclxuICAgIHdoaWxlIChub3REb25lICYmIHRyZWUuY2hpbGRyZW5baW5kZXhdKSB7XHJcbiAgICAgIGNoaWxkUm9sbHVwID0gdGhpcy5nZXRSb2xsdXAodHJlZS5jaGlsZHJlbltpbmRleF0sIGlkZW50aWZpZXIpO1xyXG4gICAgICBpZiAoY2hpbGRSb2xsdXAgJiYgY2hpbGRSb2xsdXAubGVuZ3RoKSB7XHJcbiAgICAgICAgbm90RG9uZSA9IGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICAgIGluZGV4Kys7XHJcbiAgICB9XHJcbiAgICBpZiAoY2hpbGRSb2xsdXAgJiYgY2hpbGRSb2xsdXAubGVuZ3RoKSB7XHJcbiAgICAgIHJvbGx1cC5wdXNoKC4uLmNoaWxkUm9sbHVwKTtcclxuICAgICAgcmV0dXJuIHJvbGx1cDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBbXTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGNyZWF0ZVVuaXF1ZUlkKHRvY0RhdGEsIGl0ZW0pIHtcclxuICAgIGl0ZW1bJ3NiVW5pcXVlSWRlbnRpZmllciddID0gdG9jRGF0YS5pZGVudGlmaWVyICsgJ18nICsgaXRlbS5pZGVudGlmaWVyO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQHNpbmNlICNTSC0zNjJcclxuICAgKiBAcGFyYW0gaXRlbSAtIHNlbGVjdGVkIGNoaWxkcmVuIGRhdGEuXHJcbiAgICogQGRlc2NyaXB0aW9uIC0gSXQgd2lsbCBkZXNwYXRjaCBhbiBldmVudCBvbiBpbmRpdmlkdWFsIGNoZWNrYm94IGNsaWNrXHJcbiAgICovXHJcbiAgb25JdGVtU2VsZWN0KGl0ZW0pIHtcclxuICAgIHRoaXMuc2VsZWN0ZWRJdGVtLmVtaXQoe2RhdGE6IGl0ZW19KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEBzaW5jZSAjU0gtMzYyXHJcbiAgICogQHBhcmFtIGlzU2VsZWN0QWxsIC0gYm9vbGVhbiwgd2hpY2ggd2lsbCBiZSB0cnVlL2ZhbHNlIGlmICdTZWxlY3QgYWxsIGNoZWNrYm94IGlzIGNoZWNrZWQvdW5jaGVja2VkXHJcbiAgICogQGRlc2NyaXB0aW9uIC0gdGhpcyBtZXRob2Qgd2lsbCBtYXJrIGV2ZXJ5IGNoaWxkcmVuIG9mIHRvY0RhdGEgb2JqZWN0IHdpdGggYW4gYWRkaXRpb25hbCB2YXJpYWJsZSAtXHJcbiAgICogICAgICAgICAgICAgICAgc2VsZWN0ZWQ6IHRydWUvZmFsc2UgYmFzZWQgb24gdGhlIHZhbHVlIG9mICdpc1NlbGVjdEFsbCcgYW5kIGFsc28gZGVzcGF0Y2ggYW4gZXZlbnRcclxuICAgKiAgICAgICAgICAgICAgICB3aXRoIHRoZSBkYXRhLlxyXG4gICAqL1xyXG4gIHNlbGVjdEFsbEl0ZW1zKGlzU2VsZWN0QWxsOiBib29sZWFuKSB7XHJcbiAgICB0aGlzLnRvY0RhdGFbJ2NoaWxkcmVuJ10uZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgaXRlbS5zZWxlY3RlZCA9IGlzU2VsZWN0QWxsO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLnNlbGVjdGVkSXRlbS5lbWl0KHtzZWxlY3RBbGw6IGlzU2VsZWN0QWxsLCBkYXRhOiB0aGlzLnRvY0RhdGFbJ2NoaWxkcmVuJ119KTtcclxuICB9XHJcblxyXG4gIG9uUGxheUJ1dHRvbkNsaWNrKGV2ZW50KSB7XHJcbiAgICBjb25zdCByb2xsdXAgPSB0aGlzLmdldFJvbGx1cCh0aGlzLnRvY0RhdGEsIGV2ZW50LmRhdGEuc2JVbmlxdWVJZGVudGlmaWVyKTtcclxuICAgIGlmIChyb2xsdXAubGVuZ3RoKSB7XHJcbiAgICAgIHJvbGx1cC5wb3AoKTtcclxuICAgIH1cclxuICAgIHRoaXMucGxheUJ1dHRvbkNsaWNrLmVtaXQoeyAuLi5ldmVudCwgcm9sbHVwIH0pO1xyXG4gIH1cclxuXHJcbiAgaXNGbGF0dGVuZWRUeXBlKGNvbnRlbnQpIHtcclxuICAgIGlmICghKHRoaXMudHlwZSA9PT0gVG9jQ2FyZFR5cGUuVFJBQ0tBQkxFKSB8fFxyXG4gICAgICAhKChjb250ZW50LmNvbnRlbnREYXRhICYmIGNvbnRlbnQuY29udGVudERhdGEudHJhY2thYmxlICYmIGNvbnRlbnQuY29udGVudERhdGEudHJhY2thYmxlLmVuYWJsZWQgPT09ICdZZXMnKSB8fFxyXG4gICAgICAoY29udGVudC50cmFja2FibGUgJiYgY29udGVudC50cmFja2FibGUuZW5hYmxlZCA9PT0gJ1llcycpKSkge1xyXG4gICAgICByZXR1cm4gRmxhdHRlbmVkVHlwZS5FWFBBTkQ7XHJcbiAgICB9IGVsc2UgaWYgKHRoaXMudHlwZSA9PT0gVG9jQ2FyZFR5cGUuVFJBQ0tBQkxFICYmXHJcbiAgICAgICgoY29udGVudC5jb250ZW50RGF0YSAmJiBjb250ZW50LmNvbnRlbnREYXRhLnRyYWNrYWJsZSAmJiBjb250ZW50LmNvbnRlbnREYXRhLnRyYWNrYWJsZS5lbmFibGVkID09PSAnWWVzJykgfHxcclxuICAgICAgICAoY29udGVudC50cmFja2FibGUgJiYgY29udGVudC50cmFja2FibGUuZW5hYmxlZCA9PT0gJ1llcycpKSkge1xyXG4gICAgICByZXR1cm4gRmxhdHRlbmVkVHlwZS5DT0xMQVBTRTtcclxuICAgIH1cclxuICAgIHJldHVybiAnJztcclxuICB9XHJcblxyXG4gIG5nT25EZXN0cm95KCkge1xyXG4gICAgdGhpcy5zdWJzY3JpcHRpb25zLmZvckVhY2gocyA9PiBzLnVuc3Vic2NyaWJlKCkpO1xyXG4gIH1cclxufVxyXG4iXX0=