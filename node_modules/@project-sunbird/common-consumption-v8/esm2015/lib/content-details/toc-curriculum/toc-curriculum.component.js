/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, ViewChild, ViewChildren, QueryList, Output, EventEmitter } from '@angular/core';
import { MimeTypeMasterData } from '../../pipes-module/mime-type';
import { staticData } from './toc-data';
export class TocCurriculumComponent {
    constructor() {
        this.tocData = staticData;
        this.activeMimeTypeFilter = ['all'];
        this.noContentMessage = 'No content available';
        this.isAccordion = false;
        this.isChapterListing = false;
        this.type = undefined;
        this.contentStatus = [];
        this.shadowColor = "hsl(0, 0%, 80%)";
        this.progressColor = "#024f9d";
        this.layoutConfig = {};
        this.disabled = '';
        this.tocCardClick = new EventEmitter();
        this.noContent = new EventEmitter();
        this.scoreLabel = '';
        this.isMimeTypeFilterChanged = false;
        this.isSameMimeTypeInChildren = ((/**
         * @param {?} mimeTypesCount
         * @param {?} activeMimeType
         * @return {?}
         */
        (mimeTypesCount, activeMimeType) => {
            /** @type {?} */
            const contentMimeType = Object.keys(JSON.parse(mimeTypesCount));
            return Boolean(activeMimeType.filter((/**
             * @param {?} value
             * @return {?}
             */
            value => contentMimeType.includes(value))).length);
        }));
        this.isSameMimeType = (/**
         * @param {?} currentContent
         * @return {?}
         */
        (currentContent) => this.activeMimeTypeFilter.find((/**
         * @param {?} mimeType
         * @return {?}
         */
        mimeType => mimeType === currentContent.mimeType)));
        this.isChildrenPresent = (/**
         * @param {?} currentContent
         * @return {?}
         */
        (currentContent) => Boolean(currentContent.children && currentContent.children.length));
    }
    /**
     * @return {?}
     */
    get MimeTypeMasterData() { return MimeTypeMasterData; }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.setActiveContent();
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        if (changes.activeMimeTypeFilter) {
            this.isMimeTypeFilterChanged = false;
        }
        else if (changes.tocData) {
            this.setActiveContent();
        }
    }
    /**
     * @return {?}
     */
    setActiveContent() {
        if (this.tocData && this.tocData.children) {
            /** @type {?} */
            const flattenDeepContents = this.flattenDeep(this.tocData.children);
            this.activeContent = this.firstNonCollectionContent(flattenDeepContents);
            if (!this.activeContent) {
                this.noContent.emit({ message: 'No Content Available' });
            }
        }
    }
    /**
     * @param {?} content
     * @return {?}
     */
    filterChildren(content) {
        // Check for the ActiveMimeType
        if (this.activeMimeTypeFilter.includes('all')) {
            if (content.mimeType === MimeTypeMasterData.COLLECTION) {
                return this.isShowContent(content, true);
            }
            return true; // Return true for all the content except collection mimeType
        }
        else if (content.mimeType && this.isSameMimeType(content)) {
            return true;
        }
        else if (content.mimeType === MimeTypeMasterData.COLLECTION) {
            return this.isShowContent(content, false);
        }
        else {
            return false;
        }
    }
    /**
     * @private
     * @param {?} content
     * @param {?} isActiveFilterAll
     * @return {?}
     */
    isShowContent(content, isActiveFilterAll) {
        if (content.mimeTypesCount && !isActiveFilterAll) {
            return this.isSameMimeTypeInChildren(content.mimeTypesCount, this.activeMimeTypeFilter);
        }
        else if (this.isChildrenPresent(content)) {
            /** @type {?} */
            const contentList = this.flattenDeep(content.children);
            return isActiveFilterAll ? contentList.some((/**
             * @param {?} c
             * @return {?}
             */
            (c) => c.mimeType !== MimeTypeMasterData.COLLECTION)) :
                contentList.some((/**
                 * @param {?} c
                 * @return {?}
                 */
                (c) => this.isSameMimeType(c)));
        }
        else {
            return false;
        }
    }
    /**
     * @param {?} event
     * @param {?} item
     * @return {?}
     */
    onTocChapterClick(event, item) {
        /*const rollup = this.getRollup(this.tocData, event.data.sbUniqueIdentifier);
        if (rollup.length) {
          rollup.pop();
        }*/
        this.tocCardClick.emit(Object.assign({}, event, { item }));
    }
    /**
     * @param {?} event
     * @return {?}
     */
    onTocCardClick(event) {
        /** @type {?} */
        const rollup = this.getRollup(this.tocData, event.data.sbUniqueIdentifier);
        if (rollup.length) {
            rollup.pop();
        }
        this.tocCardClick.emit(Object.assign({}, event, { rollup }));
    }
    /**
     * @param {?} event
     * @return {?}
     */
    collapsedChangeHandler(event) {
    }
    /**
     * @private
     * @param {?} contents
     * @return {?}
     */
    firstNonCollectionContent(contents) {
        return contents.find((/**
         * @param {?} content
         * @return {?}
         */
        (content) => content.mimeType !== 'application/vnd.ekstep.content-collection'));
    }
    /**
     * @private
     * @param {?} contents
     * @return {?}
     */
    flattenDeep(contents) {
        if (contents) {
            return contents.reduce((/**
             * @param {?} acc
             * @param {?} val
             * @return {?}
             */
            (acc, val) => {
                if (val.children) {
                    acc.push(val);
                    return acc.concat(this.flattenDeep(val.children));
                }
                else {
                    return acc.concat(val);
                }
            }), []);
        }
    }
    /**
     * @param {?} index
     * @param {?} item
     * @return {?}
     */
    isExpanded(index, item) {
        return Boolean(index === 0 || item && item.mimeType !== MimeTypeMasterData.COLLECTION);
    }
    /**
     * @param {?} item
     * @param {?} index
     * @return {?}
     */
    isShowBody(item, index) {
        if (item) {
            /** @type {?} */
            const isShowAllMimeType = (/**
             * @return {?}
             */
            () => this.activeMimeTypeFilter.indexOf('all') > -1);
            /** @type {?} */
            const isCollection = (/**
             * @return {?}
             */
            () => item.mimeType === MimeTypeMasterData.COLLECTION);
            /** @type {?} */
            const isMathchesMimeType = (/**
             * @return {?}
             */
            () => this.activeMimeTypeFilter.indexOf(item.mimeType) > -1);
            /** @type {?} */
            const isLastContent = (/**
             * @return {?}
             */
            () => this.tocData.children.length === index + 1);
            if (this.tocData && isShowAllMimeType() || (isCollection() || isMathchesMimeType())) {
                this.isMimeTypeFilterChanged = true;
                return true;
            }
            else if (this.activeMimeTypeFilter.indexOf(item.mimeType) < 0 && !isLastContent()) {
                return false;
            }
            else if (this.activeMimeTypeFilter.indexOf(item.mimeType) < 0 && isLastContent()) {
                if (this.isMimeTypeFilterChanged) {
                    return false;
                }
                this.isMimeTypeFilterChanged = false;
                return true;
            }
        }
        return false;
    }
    /**
     * @param {?} tree
     * @param {?} identifier
     * @return {?}
     */
    getRollup(tree, identifier) {
        /** @type {?} */
        let rollup = [tree.identifier];
        if (tree.sbUniqueIdentifier === identifier) {
            return rollup;
        }
        if (!tree.children || !tree.children.length) {
            return [];
        }
        /** @type {?} */
        let notDone = true;
        /** @type {?} */
        let childRollup;
        /** @type {?} */
        let index = 0;
        while (notDone && tree.children[index]) {
            childRollup = this.getRollup(tree.children[index], identifier);
            if (childRollup && childRollup.length) {
                notDone = false;
            }
            index++;
        }
        if (childRollup && childRollup.length) {
            rollup.push(...childRollup);
            return rollup;
        }
        else {
            return [];
        }
    }
    /**
     * @param {?} tocData
     * @param {?} item
     * @return {?}
     */
    createUniqueId(tocData, item) {
        item['sbUniqueIdentifier'] = tocData.identifier + '_' + item.identifier;
    }
    /**
     * @param {?=} item
     * @return {?}
     */
    fetchProgress(item) {
        /** @type {?} */
        var bgColor = this.progressColor;
        /** @type {?} */
        let widthStyle = item.progressPercentage != null ? item.progressPercentage + "%" : "2%";
        return {
            width: widthStyle,
            'background-color': bgColor
        };
    }
    /**
     * @param {?=} item
     * @return {?}
     */
    showCompleted(item) {
        if (item != null && item.progressPercentage != null && item.progressPercentage === 100) {
            return true;
        }
        return false;
    }
    /**
     * @param {?} item
     * @return {?}
     */
    fetchProgressShadow(item) {
        /** @type {?} */
        var bgColor = this.shadowColor;
        /** @type {?} */
        let displayStatus = item.progressPercentage != null && item.progressPercentage != "0" ? 'block' : 'none';
        return {
            'background': bgColor,
            display: displayStatus
        };
    }
    /**
     * @param {?} event
     * @return {?}
     */
    onPlayButtonClick(event) {
        /** @type {?} */
        const rollup = this.getRollup(this.tocData, event.data.sbUniqueIdentifier);
        if (rollup.length) {
            rollup.pop();
        }
        this.tocCardClick.emit(Object.assign({}, event, { rollup }));
    }
}
TocCurriculumComponent.decorators = [
    { type: Component, args: [{
                selector: 'sb-toc-curriculum',
                template: "<div *ngIf=\"isAccordion\">\r\n    <div class=\"\" *ngIf=\"tocData?.mimeType === MimeTypeMasterData?.COLLECTION\">\r\n      <sb-toc-item *ngIf=\"type\" [tocData]=\"tocData\" [type]=\"type\" [recogniseCollection]=\"true\"\r\n       (tocCardClick)=\"onTocCardClick($event)\" [contentStatus]=\"contentStatus\" (playButtonClick)=\"onPlayButtonClick($event)\">\r\n      </sb-toc-item>\r\n      <sb-toc-item *ngIf=\"!type\" [tocData]=\"tocData\" [recogniseCollection]=\"true\"></sb-toc-item>\r\n    </div>\r\n    <div class=\"\" *ngIf=\"tocData?.mimeType !== MimeTypeMasterData?.COLLECTION\">\r\n        <sb-toc-card *ngIf=\"type\" [content]=\"tocData\" [type]=\"type\" (tocCardClick)=\"onTocCardClick($event)\"[platform]=\"platform\"\r\n         [activeContent]=\"activeContent\" [contentStatus]=\"contentStatus\" [playBtnConfig]=\"playBtnConfig\" (playButtonClick)=\"onPlayButtonClick($event)\"\r\n         [trackableDefaultImage]=\"trackableDefaultImage\" [scoreLabel]=\"scoreLabel\" [maxAttempts]=\"maxAttempts\" [disabled]=\"disabled\">\r\n          </sb-toc-card>\r\n          <sb-toc-card *ngIf=\"!type\" [content]=\"tocData\"  (tocCardClick)=\"onTocCardClick($event)\" [platform]=\"platform\"\r\n            [activeContent]=\"activeContent\" [playBtnConfig]=\"playBtnConfig\" (playButtonClick)=\"onPlayButtonClick($event)\"\r\n            [trackableDefaultImage]=\"trackableDefaultImage\" [scoreLabel]=\"scoreLabel\" [maxAttempts]=\"maxAttempts\" [disabled]=\"disabled\">\r\n          </sb-toc-card>\r\n    </div>\r\n</div>\r\n<div  *ngIf=\"isChapterListing\">\r\n  <div class=\"sb-curiculum-responsive-grid\">\r\n    <div class=\"sb-curiculum__border\" *ngFor=\"let item of tocData?.children; let index = index;\" (click)=\"onTocChapterClick($event,item)\">\r\n      {{ createUniqueId(tocData, item) }}\r\n      <div class=\"sb-curiculum\" style=\"border:none;\">\r\n      <div class=\"sb--completed\" *ngIf=\"showCompleted(item)\">\r\n          <img alt=\"\" src=\"assets/common-consumption/images/completed.svg\" />\r\n      </div>\r\n      <div class=\"sb-curiculum__chapter\">\r\n        <div class=\"title\">{{item?.name}}</div>\r\n      </div>\r\n      </div>\r\n      <div class=\"sb--card__progressbar\" [ngStyle]=\"fetchProgressShadow(item)\">\r\n        <span [ngStyle]=\"fetchProgress(item)\"></span>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<div class=\"\" *ngIf=\"!isAccordion && !isChapterListing\">\r\n  \r\n  <div class=\"\">\r\n      <div class=\"sb-curiculum\" *ngFor=\"let item of tocData?.children; let index = index;\">\r\n      {{ createUniqueId(tocData, item) }}\r\n      <div class=\"sb-curiculum__chapter\" *ngIf=\"item?.mimeType === MimeTypeMasterData?.COLLECTION && item?.contentType !== 'TextBook' && item?.contentType !== 'Course'\" \r\n         (click)=\"onTocChapterClick($event,item)\">\r\n        <div class=\"title\">{{item?.name}}</div>\r\n        <div *ngIf=\"item && (item | hasMimeType: activeMimeTypeFilter);else noContent\" #chapterContainer>\r\n          <ng-container *ngIf=\"item?.mimeType !== MimeTypeMasterData?.COLLECTION && !item?.children?.length\" >\r\n            <div class=\"child-content-padding\">\r\n              <sb-toc-card *ngIf=\"type\" [content]=\"item\" [type]=\"type\" (tocCardClick)=\"onTocCardClick($event)\" [platform]=\"platform\"\r\n               [activeContent]=\"activeContent\" [contentStatus]=\"contentStatus\" [playBtnConfig]=\"playBtnConfig\" (playButtonClick)=\"onPlayButtonClick($event)\"\r\n               [trackableDefaultImage]=\"trackableDefaultImage\" [scoreLabel]=\"scoreLabel\" [maxAttempts]=\"maxAttempts\" [disabled]=\"disabled\">\r\n              </sb-toc-card>\r\n              <sb-toc-card *ngIf=\"!type\" [content]=\"item\" (tocCardClick)=\"onTocCardClick($event)\" [platform]=\"platform\"\r\n                [activeContent]=\"activeContent\" [playBtnConfig]=\"playBtnConfig\" (playButtonClick)=\"onPlayButtonClick($event)\"\r\n                [trackableDefaultImage]=\"trackableDefaultImage\" [scoreLabel]=\"scoreLabel\" [maxAttempts]=\"maxAttempts\" [disabled]=\"disabled\">\r\n              </sb-toc-card>\r\n            </div>\r\n          </ng-container>\r\n          <ng-container *ngIf=\"item?.children?.length\">\r\n            <ng-container *ngFor=\"let child of item?.children; let j = index;\">\r\n              {{ createUniqueId(item, child) }}\r\n              <div class=\"sbchapter\" *ngIf=\"filterChildren(child) && child.item?.contentType === 'TextBook'\">\r\n                <sb-library-card></sb-library-card>\r\n              </div>\r\n              <div class=\"sbchapter\" *ngIf=\"filterChildren(child) && child.item?.contentType === 'Course'\">\r\n                <sb-course-card></sb-course-card>\r\n              </div>\r\n              <div class=\"sbchapter\" *ngIf=\"filterChildren(child)\">\r\n                <sb-toc-child-item *ngIf=\"type\" [childData]=\"child\" [type]=\"type\" [activeMimeTypeFilter]=\"activeMimeTypeFilter\"\r\n                  [activeContent]=\"activeContent\" [contentStatus]=\"contentStatus\" (tocCardClick)=\"onTocCardClick($event)\" \r\n                  [playBtnConfig]=\"playBtnConfig\" (playButtonClick)=\"onPlayButtonClick($event)\" [platform]=\"platform\"\r\n                  [trackableDefaultImage]=\"trackableDefaultImage\">\r\n                </sb-toc-child-item>\r\n                <sb-toc-child-item *ngIf=\"!type\" [childData]=\"child\" [activeMimeTypeFilter]=\"activeMimeTypeFilter\"\r\n                  [activeContent]=\"activeContent\" (tocCardClick)=\"onTocCardClick($event)\" [playBtnConfig]=\"playBtnConfig\"\r\n                  (playButtonClick)=\"onPlayButtonClick($event)\" [platform]=\"platform\" [trackableDefaultImage]=\"trackableDefaultImage\">\r\n                </sb-toc-child-item>\r\n              </div>\r\n            </ng-container>\r\n          </ng-container>\r\n        </div>\r\n        <ng-template #noContent>\r\n          <div class=\"heading\">{{noContentMessage}}</div>\r\n        </ng-template>\r\n      </div>\r\n      <div class=\"sb-curiculum__chapter\" *ngIf=\"item?.mimeType !== MimeTypeMasterData?.COLLECTION\">\r\n          <sb-toc-card *ngIf=\"type\" [content]=\"item\" [type]=\"type\" (tocCardClick)=\"onTocCardClick($event)\" [platform]=\"platform\"\r\n          [activeContent]=\"activeContent\" [contentStatus]=\"contentStatus\" [playBtnConfig]=\"playBtnConfig\" (playButtonClick)=\"onPlayButtonClick($event)\"\r\n          [trackableDefaultImage]=\"trackableDefaultImage\" [scoreLabel]=\"scoreLabel\" [maxAttempts]=\"maxAttempts\" [disabled]=\"disabled\">\r\n            </sb-toc-card>\r\n      </div>\r\n      <div class=\"sb-curiculum__chapter\" *ngIf=\"item?.mimeType === MimeTypeMasterData?.COLLECTION && item?.contentType === 'TextBook'\">\r\n          <sb-library-card [content]=\"item\"></sb-library-card>\r\n      </div>\r\n      <div class=\"sb-curiculum__chapter\" *ngIf=\"item?.mimeType === MimeTypeMasterData?.COLLECTION && item?.contentType === 'Course'\">\r\n          <sb-course-card [course]=\"item\"></sb-course-card>\r\n        </div>\r\n    </div>\r\n    </div>\r\n</div>",
                styles: [".sb--card__progressbar{margin:1rem!important;width:unset!important}.sb-curiculum-responsive-grid{padding:.5rem .5rem 1rem;display:block}.sb-curiculum-responsive-grid .sb-curiculum__border{background:var(--white);box-shadow:0 2px 7px rgba(var(--rc-rgba-black),.16);margin:.5rem 0;padding:.125rem 0}.sb-curiculum-responsive-grid .sb-curiculum__border.active,.sb-curiculum-responsive-grid .sb-curiculum__border:active,.sb-curiculum-responsive-grid .sb-curiculum__border:hover{box-shadow:0 2px 7px rgba(var(--rc-009D53),.65)}.sb-curiculum-responsive-grid .sb-curiculum__border .sb-curiculum.active,.sb-curiculum-responsive-grid .sb-curiculum__border .sb-curiculum:active,.sb-curiculum-responsive-grid .sb-curiculum__border .sb-curiculum:hover{box-shadow:none}.sb-curiculum-responsive-grid .sb-curiculum{position:relative;border-radius:.5rem;padding:.5rem 2.125rem 0 1rem;border:1px solid var(--primary-200);background:var(--white);font-weight:700;display:flex;min-height:48px;flex-direction:column}.sb-curiculum-responsive-grid .sb-curiculum.active,.sb-curiculum-responsive-grid .sb-curiculum:active,.sb-curiculum-responsive-grid .sb-curiculum:hover{box-shadow:0 2px 7px rgba(var(--rc-009D53),.65)}.sb-curiculum-responsive-grid .sb-curiculum__chapter{display:flex;align-items:flex-start;flex:1}.sb-curiculum-responsive-grid .sb-curiculum__chapter .title{font-size:.875rem;color:#3a3a3a;line-height:1.25rem;display:-webkit-box;-webkit-line-clamp:3;overflow:hidden;text-overflow:ellipsis;word-break:break-all}.sb-curiculum-responsive-grid .sb--completed{position:absolute;top:.875rem;right:.5rem}", ".loading-animation{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite;-webkit-animation-name:placeload;animation-name:placeload;-webkit-animation-timing-function:linear;animation-timing-function:linear;background:var(--lazyload-bg);background:var(--grey-nuance-lighter);background:linear-gradient(to right,var(--grey-nuance-lighter) 8%,var(--grey-nuance-darker) 18%,var(--grey-nuance-lighter) 33%);background-size:75rem 6.5rem;position:relative}@-webkit-keyframes placeload{0%{background-position:-29.25rem 0}100%{background-position:29.25rem 0}}@keyframes placeload{0%{background-position:-29.25rem 0}100%{background-position:29.25rem 0}}.sb--card--highlighter{height:.75rem;width:100%;margin-top:.3125rem}:host .layout-library{display:flex;flex-direction:column}:host .header{display:flex;flex-direction:row;padding:0;align-items:center}[dir=ltr] :host .header,[dir=rtl] :host .header{margin:1.5rem 0 1rem}:host .header .title{font-family:inherit;text-overflow:ellipsis;overflow:hidden;flex:1;height:1.5rem;color:var(--primary-color);font-size:1.125rem;font-weight:700;text-transform:capitalize;line-height:1.625rem;display:flex;align-items:center}:host .header .title i{vertical-align:middle;height:1.0625rem;width:.875rem;top:0}[dir=ltr] :host .header .title i{margin-right:.5rem}[dir=rtl] :host .header .title i{margin-left:.5rem}:host .header .title .badge{display:inline-block;background:var(--rc-d4d3d3);color:var(--gray-800);text-align:center;padding:0 .75rem;border-radius:.25rem;height:1.5rem;line-height:1.5rem;font-size:1rem;font-weight:400}[dir=ltr] :host .header .title .badge{margin-left:.5rem}[dir=rtl] :host .header .title .badge{margin-right:.5rem}:host .cards-containers{display:-ms-grid;display:grid;grid-template-columns:repeat(auto-fill,minmax(292px,1fr));grid-gap:1rem;grid-row-gap:1.5rem}:host .cards-containers--show-1{grid-template-columns:repeat(auto-fill,minmax(calc(100% / 1.5),1fr))}:host .cards-containers--show-2{grid-template-columns:repeat(auto-fill,minmax(calc(100% / 2.5),1fr))}:host .cards-containers--show-3{grid-template-columns:repeat(auto-fill,minmax(calc(100% / 3.5),1fr))}:host .cards-containers--show-4{grid-template-columns:repeat(auto-fill,minmax(calc(100% / 4.5),1fr))}:host .cards-containers--show-5{grid-template-columns:repeat(auto-fill,minmax(calc(100% / 5.5),1fr))}:host .cards-container{display:flex;flex-direction:row;flex-wrap:wrap;margin:-1.5rem -.5rem 0}:host .cards-container .item{box-sizing:border-box;margin-top:1.5rem}[dir=ltr] :host .cards-container .item,[dir=rtl] :host .cards-container .item{padding:0 .5rem}@media (max-width:767px){:host .cards-container .item{margin-top:1rem}}:host .cards-container .item.show-1{max-width:100%}:host .cards-container .item.show-2{flex:0 0 50%;max-width:50%}:host .cards-container .item.show-3{flex:0 0 33.33%;max-width:33.33%}:host .cards-container .item.show-4{flex:0 0 25%;max-width:25%}:host .cards-container .item.show-5{flex:0 0 20%;max-width:20%}@media (max-width:991px){:host .cards-containers--show-3,:host .cards-containers--show-4,:host .cards-containers--show-5{grid-template-columns:repeat(auto-fill,minmax(calc(100% / 2.5),1fr))}:host .cards-container .item.show-2,:host .cards-container .item.show-3,:host .cards-container .item.show-4,:host .cards-container .item.show-5{flex:0 0 50%;max-width:50%}}@media (max-width:575px){:host .cards-containers--show-2,:host .cards-containers--show-3,:host .cards-containers--show-4,:host .cards-containers--show-5{grid-template-columns:repeat(auto-fill,minmax(calc(100% / 1.5),1fr))}:host .cards-container .item.show-2,:host .cards-container .item.show-3,:host .cards-container .item.show-4,:host .cards-container .item.show-5{flex:0 0 100%;max-width:100%}}@media (min-width:992px) and (max-width:1279px){:host .cards-containers--show-4,:host .cards-containers--show-5{grid-template-columns:repeat(auto-fill,minmax(calc(100% / 3.5),1fr))}:host .cards-container .item.show-4,:host .cards-container .item.show-5{flex:0 0 33.33%;max-width:33.33%}}", ".loading-animation{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite;-webkit-animation-name:placeload;animation-name:placeload;-webkit-animation-timing-function:linear;animation-timing-function:linear;background:var(--lazyload-bg);background:var(--grey-nuance-lighter);background:linear-gradient(to right,var(--grey-nuance-lighter) 8%,var(--grey-nuance-darker) 18%,var(--grey-nuance-lighter) 33%);background-size:75rem 6.5rem;position:relative}@-webkit-keyframes placeload{0%{background-position:-29.25rem 0}100%{background-position:29.25rem 0}}@keyframes placeload{0%{background-position:-29.25rem 0}100%{background-position:29.25rem 0}}.sb--card--highlighter{height:.75rem;width:100%;margin-top:.3125rem}:host .sb--card{width:100%;background-color:var(--white);display:flex;flex-direction:column;cursor:pointer;position:relative;margin-top:0;border:0;contain:content;border-radius:.125rem}:host .sb--card:hover{transform:translate(0,0);box-shadow:0 .125rem .4375rem 0 rgba(var(--rc-rgba-black),.16)}@media (max-width:767px){:host .sb--card{box-shadow:0 .125rem .4375rem rgba(var(--rc-rgba-black),.16)}}:host .sb--card__main-area{display:flex;flex-direction:row;align-items:center;height:5.5rem}:host .sb--card__img{height:4.5rem;width:4.5rem;overflow:hidden;flex:0 0 4.5rem;margin:.5rem}:host .sb--card__img .img-container{display:flex;align-items:center;background-color:var(--gray-100);height:4.5rem;width:4.5rem;justify-content:center}:host .sb--card__img .img-container img{max-width:100%}:host .sb--card__info{flex:1;overflow:hidden}[dir=ltr] :host .sb--card__info{padding-right:.5rem}[dir=rtl] :host .sb--card__info{padding-left:.5rem}:host .sb--card__title{color:var(--primary-color);font-size:.875rem;margin:0;line-height:1.25rem}:host .sb--card__meta1{color:var(--gray-800);font-size:.75rem;display:flex;flex-direction:row;align-items:center;flex:1;line-height:1.25rem;margin-top:.25rem}:host .sb--card .data_1{max-width:50%}:host .sb--card .data_2{flex:1}:host .sb--card .dot-divider{width:.25rem;height:.25rem;min-width:.25rem;max-width:.25rem;min-height:.25rem;max-height:.25rem;border-radius:100%;background-color:var(--gray-200);display:inline-block;margin:0 .5rem}:host .sb--card__moreinfo{border-radius:0 0 .125rem .125rem;background-color:var(--rc-FAFAFA);display:flex;flex-direction:row;align-items:stretch;justify-content:space-between;min-height:3.5rem;border-top:0 solid #cacbce}:host .sb--card__meta2{color:var(--gray-800);font-size:.75rem;line-height:.875rem;display:flex;flex-direction:column;flex-wrap:wrap;justify-content:space-around;padding:.5rem}:host .sb--card__meta2_data .label{font-weight:400}:host .sb--card__meta2_data .value{font-weight:700}:host .sb--card__org{color:var(--gray-200)}:host .sb--card__tags{display:flex;flex-direction:row;align-items:center;justify-content:flex-end;flex:1}:host .sb--card__badge{display:flex}:host .sb--card__badge img{width:1.25rem;height:1.25rem}:host .sb--card__type{background:var(--gray-200);position:relative;height:1.25rem;color:var(--white);font-size:.625rem;display:flex;align-items:center}[dir=ltr] :host .sb--card__type{padding-left:.25rem;padding-right:.5rem;margin-left:1rem}[dir=rtl] :host .sb--card__type{padding-left:.5rem;padding-right:.25rem;margin-right:1rem}:host .sb--card__type:before{content:\"\";width:0;height:0;border-width:.625rem .3125rem;border-style:solid;border-color:var(--gray-200) var(--gray-200) var(--gray-200) transparent;position:absolute;left:-10px}html[dir=rtl] :host .sb--card__type:before{right:-.625rem;left:inherit;border-color:var(--gray-200) transparent var(--gray-200) var(--gray-200)}:host .sb--card--recently-viewed .sb--card__img{height:5.5rem;width:5.5rem;flex:0 0 5.5rem;margin:0}:host .sb--card--recently-viewed .sb--card__img .img-container{display:flex;align-items:center;background-color:var(--gray-100);height:5.5rem;width:5.5rem}:host .sb--card--recently-viewed .sb--card__info{padding:.5rem;flex:1}:host .sb--card.selected{border:1px solid #024f9d;border-radius:4px;background-color:rgba(2,79,157,.2)}:host .sb--card.offline .sb--card__img .img-container{display:flex;align-items:center;background-color:var(--tertiary-color);opacity:.5}:host .sb--card.offline .sb--card__img .img-container img{margin:auto;font-size:1.5rem;color:var(--white)}:host .sb--card.offline .sb--card__info,:host .sb--card.offline .sb--card__moreinfo{opacity:.5}:host .sb--card__progressbar{height:.25rem;margin:0;border-radius:0;box-shadow:inset 0 -.0625rem .0625rem rgba(var(--rc-rgba-white),.3);width:100%;background:var(--gray-100)}:host .sb--card__progressbar>span{display:block;height:100%;background-color:var(--secondary-200);background-image:-webkit-gradient(center bottom,var(--secondary-400),var(--secondary-200));box-shadow:inset 0 .125rem .5625rem var(--gray-100),inset 0 -.125rem .375rem rgba(var(--rc-rgba-black),.4);position:relative;overflow:hidden}:host .animate>span:after{content:\"\";position:absolute;top:0;left:0;bottom:0;right:0;background-image:-webkit-gradient(linear,0 0,100% 100%,color-stop(.25,rgba(var(--rc-rgba-white),.2)),color-stop(.25,transparent),color-stop(.5,transparent),color-stop(.5,rgba(var(--rc-rgba-white),.2)),color-stop(.75,rgba(var(--rc-rgba-white),.2)),color-stop(.75,transparent),to(transparent));z-index:1;background-size:3.125rem 3.125rem;overflow:hidden;-webkit-animation:2s linear infinite move;border-radius:1.25rem .5rem .5rem 1.25rem}@-webkit-keyframes move{0%{background-position:0 0}100%{background-position:3.125rem 3.125rem}}:host .completed>span{background-color:var(--secondary-color);background-image:-webkit-linear-gradient(var(--secondary-100),var(--secondary-400))}:host .inprogress>span{background-color:var(--tertiary-color);background-image:-webkit-linear-gradient(var(--tertiary-100),var(--tertiary-400))}:host .notcompleted>span{background-color:var(--red-100);background-image:-webkit-linear-gradient(var(--red-100),var(--red-400))}:host .nostripes>span,:host .nostripes>span:after{-webkit-animation:none;-moz-animation:none;background-image:none}:host .border-top-r-left-right{border-top-left-radius:0;border-top-right-radius:0}::ng-deep .card-hover{display:none;transition:.2s ease-in}::ng-deep .sb--card:hover .card-hover{display:block;z-index:1001}::ng-deep .sb--card:hover .card-hover .child-content{color:var(--white);position:absolute;left:0;right:0;top:0;bottom:0;opacity:.95;border-radius:.125rem;background-color:var(--primary-color);z-index:1;display:flex;align-items:center;transition:.2s ease-in;flex-direction:column;justify-content:space-evenly}::ng-deep .sb--card:hover .card-hover .action-container{display:flex;width:100%;justify-content:center;align-self:center;justify-self:center;flex:1;align-items:center}::ng-deep .sb--card:hover .card-hover .action-item{padding:0 1rem;flex:1;text-align:center}::ng-deep .sb--card:hover .card-hover .action-item .sb-btn.sb-btn-primary[disabled]{background-color:transparent;opacity:.5;border:0;color:var(--white)}::ng-deep .sb--card:hover .card-hover .action-item:not(:last-child){border-right:.0625rem solid rgba(var(--rc-rgba-white),.5)}::ng-deep .sb--card:hover .card-hover .hover-meta-info{font-size:.625rem;opacity:.8;color:var(--white);line-height:.75rem;flex:0 0 25%}.menu::after{content:'\\2807';font-size:1.5rem;color:var(--gray-200);text-align:center;align-items:center;display:flex;justify-content:center;border-radius:50%;padding-left:.375rem;cursor:pointer;width:2rem;height:2rem}.menu:hover::after{background:var(--gray-0)}"]
            }] }
];
/** @nocollapse */
TocCurriculumComponent.ctorParameters = () => [];
TocCurriculumComponent.propDecorators = {
    tocData: [{ type: Input }],
    activeMimeTypeFilter: [{ type: Input }],
    noContentMessage: [{ type: Input }],
    isAccordion: [{ type: Input }],
    isChapterListing: [{ type: Input }],
    type: [{ type: Input }],
    contentStatus: [{ type: Input }],
    shadowColor: [{ type: Input }],
    progressColor: [{ type: Input }],
    refresh: [{ type: Input }],
    layoutConfig: [{ type: Input }],
    playBtnConfig: [{ type: Input }],
    platform: [{ type: Input }],
    trackableDefaultImage: [{ type: Input }],
    maxAttempts: [{ type: Input }],
    disabled: [{ type: Input }],
    divs: [{ type: ViewChild, args: ['chapter', { static: false },] }],
    chapterContainer: [{ type: ViewChildren, args: ['chapterContainer',] }],
    activeContent: [{ type: Input }],
    tocCardClick: [{ type: Output }],
    noContent: [{ type: Output }],
    scoreLabel: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    TocCurriculumComponent.prototype.tocData;
    /** @type {?} */
    TocCurriculumComponent.prototype.activeMimeTypeFilter;
    /** @type {?} */
    TocCurriculumComponent.prototype.noContentMessage;
    /** @type {?} */
    TocCurriculumComponent.prototype.isAccordion;
    /** @type {?} */
    TocCurriculumComponent.prototype.isChapterListing;
    /** @type {?} */
    TocCurriculumComponent.prototype.type;
    /** @type {?} */
    TocCurriculumComponent.prototype.contentStatus;
    /** @type {?} */
    TocCurriculumComponent.prototype.shadowColor;
    /** @type {?} */
    TocCurriculumComponent.prototype.progressColor;
    /** @type {?} */
    TocCurriculumComponent.prototype.refresh;
    /** @type {?} */
    TocCurriculumComponent.prototype.layoutConfig;
    /** @type {?} */
    TocCurriculumComponent.prototype.playBtnConfig;
    /** @type {?} */
    TocCurriculumComponent.prototype.platform;
    /** @type {?} */
    TocCurriculumComponent.prototype.trackableDefaultImage;
    /** @type {?} */
    TocCurriculumComponent.prototype.maxAttempts;
    /** @type {?} */
    TocCurriculumComponent.prototype.disabled;
    /** @type {?} */
    TocCurriculumComponent.prototype.divs;
    /** @type {?} */
    TocCurriculumComponent.prototype.chapterContainer;
    /** @type {?} */
    TocCurriculumComponent.prototype.activeContent;
    /** @type {?} */
    TocCurriculumComponent.prototype.tocCardClick;
    /** @type {?} */
    TocCurriculumComponent.prototype.noContent;
    /** @type {?} */
    TocCurriculumComponent.prototype.scoreLabel;
    /** @type {?} */
    TocCurriculumComponent.prototype.isMimeTypeFilterChanged;
    /**
     * @type {?}
     * @private
     */
    TocCurriculumComponent.prototype.isSameMimeTypeInChildren;
    /**
     * @type {?}
     * @private
     */
    TocCurriculumComponent.prototype.isSameMimeType;
    /**
     * @type {?}
     * @private
     */
    TocCurriculumComponent.prototype.isChildrenPresent;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidG9jLWN1cnJpY3VsdW0uY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQHByb2plY3Qtc3VuYmlyZC9jb21tb24tY29uc3VtcHRpb24tdjgvIiwic291cmNlcyI6WyJsaWIvY29udGVudC1kZXRhaWxzL3RvYy1jdXJyaWN1bHVtL3RvYy1jdXJyaWN1bHVtLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBVSxLQUFLLEVBQUUsU0FBUyxFQUFFLFlBQVksRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUNuSCxPQUFPLEVBQWdCLGtCQUFrQixFQUFFLE1BQU0sOEJBQThCLENBQUM7QUFDaEYsT0FBTyxFQUFDLFVBQVUsRUFBQyxNQUFNLFlBQVksQ0FBQztBQVV0QyxNQUFNLE9BQU8sc0JBQXNCO0lBcUNqQztRQW5DUyxZQUFPLEdBQUcsVUFBVSxDQUFDO1FBQ3JCLHlCQUFvQixHQUFHLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDL0IscUJBQWdCLEdBQUcsc0JBQXNCLENBQUM7UUFDMUMsZ0JBQVcsR0FBWSxLQUFLLENBQUM7UUFDN0IscUJBQWdCLEdBQVksS0FBSyxDQUFDO1FBQ2xDLFNBQUksR0FBRyxTQUFTLENBQUM7UUFDakIsa0JBQWEsR0FBRyxFQUFFLENBQUM7UUFDbkIsZ0JBQVcsR0FBRyxpQkFBaUIsQ0FBQztRQUNoQyxrQkFBYSxHQUFHLFNBQVMsQ0FBQztRQUUxQixpQkFBWSxHQUFHLEVBQUUsQ0FBQztRQUtsQixhQUFRLEdBQUcsRUFBRSxDQUFDO1FBS2IsaUJBQVksR0FBc0IsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUNyRCxjQUFTLEdBQXNCLElBQUksWUFBWSxFQUFFLENBQUM7UUFDbkQsZUFBVSxHQUFHLEVBQUUsQ0FBQztRQUl6Qiw0QkFBdUIsR0FBRyxLQUFLLENBQUM7UUFFeEIsNkJBQXdCLEdBQUc7Ozs7O1FBQUMsQ0FB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Ozs7O0lBdEJOLHlDQUE4Qjs7SUFDOUIsc0RBQXdDOztJQUN4QyxrREFBbUQ7O0lBQ25ELDZDQUFzQzs7SUFDdEMsa0RBQTJDOztJQUMzQyxzQ0FBMEI7O0lBQzFCLCtDQUE0Qjs7SUFDNUIsNkNBQXlDOztJQUN6QywrQ0FBbUM7O0lBQ25DLHlDQUEwQjs7SUFDMUIsOENBQTJCOztJQUMzQiwrQ0FBdUI7O0lBQ3ZCLDBDQUFrQjs7SUFDbEIsdURBQStCOztJQUMvQiw2Q0FBcUI7O0lBQ3JCLDBDQUF1Qjs7SUFDdkIsc0NBQTBEOztJQUMxRCxrREFBbUU7O0lBRW5FLCtDQUF1Qjs7SUFDdkIsOENBQStEOztJQUMvRCwyQ0FBNEQ7O0lBQzVELDRDQUF5Qjs7SUFJekIseURBQWdDOzs7OztJQUVoQywwREFHRzs7Ozs7SUFDSCxnREFBOEg7Ozs7O0lBQzlILG1EQUFtSCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBJbnB1dCwgVmlld0NoaWxkLCBWaWV3Q2hpbGRyZW4sIFF1ZXJ5TGlzdCwgT3V0cHV0LCBFdmVudEVtaXR0ZXIgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgTWltZVR5cGVQaXBlLCBNaW1lVHlwZU1hc3RlckRhdGEgfSBmcm9tICcuLi8uLi9waXBlcy1tb2R1bGUvbWltZS10eXBlJztcclxuaW1wb3J0IHtzdGF0aWNEYXRhfSBmcm9tICcuL3RvYy1kYXRhJztcclxuaW1wb3J0IHsgaXNOZ1RlbXBsYXRlIH0gZnJvbSAnQGFuZ3VsYXIvY29tcGlsZXInO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdzYi10b2MtY3VycmljdWx1bScsXHJcbiAgdGVtcGxhdGVVcmw6ICcuL3RvYy1jdXJyaWN1bHVtLmNvbXBvbmVudC5odG1sJyxcclxuICBzdHlsZVVybHM6IFsnLi90b2MtY3VycmljdWx1bS5jb21wb25lbnQuc2NzcycsXHJcbiAgJy4uLy4uL2xheW91dC9saWJyYXJ5LWNhcmRzLWdyaWQvbGlicmFyeS1jYXJkcy1ncmlkLmNvbXBvbmVudC5zY3NzJyxcclxuICAnLi4vLi4vY2FyZC9saWJyYXJ5LWNhcmQvbGlicmFyeS1jYXJkLmNvbXBvbmVudC5zY3NzJ11cclxufSlcclxuZXhwb3J0IGNsYXNzIFRvY0N1cnJpY3VsdW1Db21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xyXG5cclxuICBASW5wdXQoKSB0b2NEYXRhID0gc3RhdGljRGF0YTtcclxuICBASW5wdXQoKSBhY3RpdmVNaW1lVHlwZUZpbHRlciA9IFsnYWxsJ107XHJcbiAgQElucHV0KCkgbm9Db250ZW50TWVzc2FnZSA9ICdObyBjb250ZW50IGF2YWlsYWJsZSc7XHJcbiAgQElucHV0KCkgaXNBY2NvcmRpb246IGJvb2xlYW4gPSBmYWxzZTtcclxuICBASW5wdXQoKSBpc0NoYXB0ZXJMaXN0aW5nOiBib29sZWFuID0gZmFsc2U7XHJcbiAgQElucHV0KCkgdHlwZSA9IHVuZGVmaW5lZDtcclxuICBASW5wdXQoKSBjb250ZW50U3RhdHVzID0gW107XHJcbiAgQElucHV0KCkgc2hhZG93Q29sb3IgPSBcImhzbCgwLCAwJSwgODAlKVwiO1xyXG4gIEBJbnB1dCgpIHByb2dyZXNzQ29sb3IgPSBcIiMwMjRmOWRcIjtcclxuICBASW5wdXQoKSByZWZyZXNoOiBib29sZWFuO1xyXG4gIEBJbnB1dCgpIGxheW91dENvbmZpZyA9IHt9O1xyXG4gIEBJbnB1dCgpIHBsYXlCdG5Db25maWc7XHJcbiAgQElucHV0KCkgcGxhdGZvcm07XHJcbiAgQElucHV0KCkgdHJhY2thYmxlRGVmYXVsdEltYWdlO1xyXG4gIEBJbnB1dCgpIG1heEF0dGVtcHRzO1xyXG4gIEBJbnB1dCgpIGRpc2FibGVkID0gJyc7XHJcbiAgQFZpZXdDaGlsZCgnY2hhcHRlcicse3N0YXRpYzpmYWxzZX0pIGRpdnM6IFF1ZXJ5TGlzdDxhbnk+O1xyXG4gIEBWaWV3Q2hpbGRyZW4oJ2NoYXB0ZXJDb250YWluZXInKSBjaGFwdGVyQ29udGFpbmVyOiBRdWVyeUxpc3Q8YW55PjtcclxuXHJcbiAgQElucHV0KCkgYWN0aXZlQ29udGVudDtcclxuICBAT3V0cHV0KCkgdG9jQ2FyZENsaWNrOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICBAT3V0cHV0KCkgbm9Db250ZW50OiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICBASW5wdXQoKSBzY29yZUxhYmVsID0gJyc7XHJcblxyXG4gIGdldCBNaW1lVHlwZU1hc3RlckRhdGEoKSB7IHJldHVybiBNaW1lVHlwZU1hc3RlckRhdGE7IH1cclxuXHJcbiAgaXNNaW1lVHlwZUZpbHRlckNoYW5nZWQgPSBmYWxzZTtcclxuXHJcbiAgcHJpdmF0ZSBpc1NhbWVNaW1lVHlwZUluQ2hpbGRyZW4gPSAoKG1pbWVUeXBlc0NvdW50LCBhY3RpdmVNaW1lVHlwZSkgPT4ge1xyXG4gICAgY29uc3QgY29udGVudE1pbWVUeXBlID0gT2JqZWN0LmtleXMoSlNPTi5wYXJzZShtaW1lVHlwZXNDb3VudCkpO1xyXG4gICAgcmV0dXJuIEJvb2xlYW4oYWN0aXZlTWltZVR5cGUuZmlsdGVyKHZhbHVlID0+IGNvbnRlbnRNaW1lVHlwZS5pbmNsdWRlcyh2YWx1ZSkpLmxlbmd0aCk7XHJcbiAgfSk7XHJcbiAgcHJpdmF0ZSBpc1NhbWVNaW1lVHlwZSA9IChjdXJyZW50Q29udGVudCkgPT4gdGhpcy5hY3RpdmVNaW1lVHlwZUZpbHRlci5maW5kKG1pbWVUeXBlID0+IG1pbWVUeXBlID09PSBjdXJyZW50Q29udGVudC5taW1lVHlwZSk7XHJcbiAgcHJpdmF0ZSBpc0NoaWxkcmVuUHJlc2VudCA9IChjdXJyZW50Q29udGVudCkgPT4gQm9vbGVhbihjdXJyZW50Q29udGVudC5jaGlsZHJlbiAmJiBjdXJyZW50Q29udGVudC5jaGlsZHJlbi5sZW5ndGgpO1xyXG5cclxuICBjb25zdHJ1Y3RvcigpIHsgfVxyXG5cclxuICBuZ09uSW5pdCgpIHtcclxuICAgIHRoaXMuc2V0QWN0aXZlQ29udGVudCgpO1xyXG4gIH1cclxuXHJcbiAgbmdPbkNoYW5nZXMoY2hhbmdlcykge1xyXG4gICAgaWYgKGNoYW5nZXMuYWN0aXZlTWltZVR5cGVGaWx0ZXIpIHtcclxuICAgICAgdGhpcy5pc01pbWVUeXBlRmlsdGVyQ2hhbmdlZCA9IGZhbHNlO1xyXG4gICAgfSBlbHNlIGlmIChjaGFuZ2VzLnRvY0RhdGEpIHtcclxuICAgICAgdGhpcy5zZXRBY3RpdmVDb250ZW50KCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRBY3RpdmVDb250ZW50KCkge1xyXG4gICAgaWYgKHRoaXMudG9jRGF0YSAmJiB0aGlzLnRvY0RhdGEuY2hpbGRyZW4pIHtcclxuICAgICAgY29uc3QgZmxhdHRlbkRlZXBDb250ZW50cyA9IHRoaXMuZmxhdHRlbkRlZXAodGhpcy50b2NEYXRhLmNoaWxkcmVuKTtcclxuICAgICAgdGhpcy5hY3RpdmVDb250ZW50ID0gdGhpcy5maXJzdE5vbkNvbGxlY3Rpb25Db250ZW50KGZsYXR0ZW5EZWVwQ29udGVudHMpO1xyXG5cclxuICAgICAgaWYgKCF0aGlzLmFjdGl2ZUNvbnRlbnQpIHtcclxuICAgICAgICB0aGlzLm5vQ29udGVudC5lbWl0KHsgbWVzc2FnZTogJ05vIENvbnRlbnQgQXZhaWxhYmxlJyB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHVibGljIGZpbHRlckNoaWxkcmVuKGNvbnRlbnQpIHtcclxuICAgIC8vIENoZWNrIGZvciB0aGUgQWN0aXZlTWltZVR5cGVcclxuICAgIGlmICh0aGlzLmFjdGl2ZU1pbWVUeXBlRmlsdGVyLmluY2x1ZGVzKCdhbGwnKSkge1xyXG4gICAgICBpZiAoY29udGVudC5taW1lVHlwZSA9PT0gTWltZVR5cGVNYXN0ZXJEYXRhLkNPTExFQ1RJT04pIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5pc1Nob3dDb250ZW50KGNvbnRlbnQsIHRydWUpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB0cnVlOyAvLyBSZXR1cm4gdHJ1ZSBmb3IgYWxsIHRoZSBjb250ZW50IGV4Y2VwdCBjb2xsZWN0aW9uIG1pbWVUeXBlXHJcbiAgICB9IGVsc2UgaWYgKGNvbnRlbnQubWltZVR5cGUgJiYgdGhpcy5pc1NhbWVNaW1lVHlwZShjb250ZW50KSkge1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH0gZWxzZSBpZiAoY29udGVudC5taW1lVHlwZSA9PT0gTWltZVR5cGVNYXN0ZXJEYXRhLkNPTExFQ1RJT04pIHtcclxuICAgICAgcmV0dXJuIHRoaXMuaXNTaG93Q29udGVudChjb250ZW50LCBmYWxzZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGlzU2hvd0NvbnRlbnQoY29udGVudCwgaXNBY3RpdmVGaWx0ZXJBbGwpIHtcclxuICAgIGlmIChjb250ZW50Lm1pbWVUeXBlc0NvdW50ICYmICFpc0FjdGl2ZUZpbHRlckFsbCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5pc1NhbWVNaW1lVHlwZUluQ2hpbGRyZW4oY29udGVudC5taW1lVHlwZXNDb3VudCwgdGhpcy5hY3RpdmVNaW1lVHlwZUZpbHRlcik7XHJcbiAgICB9IGVsc2UgaWYgKHRoaXMuaXNDaGlsZHJlblByZXNlbnQoY29udGVudCkpIHtcclxuICAgICAgY29uc3QgY29udGVudExpc3QgPSB0aGlzLmZsYXR0ZW5EZWVwKGNvbnRlbnQuY2hpbGRyZW4pO1xyXG4gICAgICByZXR1cm4gaXNBY3RpdmVGaWx0ZXJBbGwgPyBjb250ZW50TGlzdC5zb21lKChjKSA9PiBjLm1pbWVUeXBlICE9PSBNaW1lVHlwZU1hc3RlckRhdGEuQ09MTEVDVElPTikgOlxyXG4gICAgICAgIGNvbnRlbnRMaXN0LnNvbWUoKGMpID0+IHRoaXMuaXNTYW1lTWltZVR5cGUoYykpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHVibGljIG9uVG9jQ2hhcHRlckNsaWNrKGV2ZW50LGl0ZW0pIHtcclxuICAgIC8qY29uc3Qgcm9sbHVwID0gdGhpcy5nZXRSb2xsdXAodGhpcy50b2NEYXRhLCBldmVudC5kYXRhLnNiVW5pcXVlSWRlbnRpZmllcik7XHJcbiAgICBpZiAocm9sbHVwLmxlbmd0aCkge1xyXG4gICAgICByb2xsdXAucG9wKCk7XHJcbiAgICB9Ki9cclxuICAgIHRoaXMudG9jQ2FyZENsaWNrLmVtaXQoeyAuLi5ldmVudCwgaXRlbSB9KTtcclxuICB9XHJcbiAgcHVibGljIG9uVG9jQ2FyZENsaWNrKGV2ZW50KSB7XHJcbiAgICBjb25zdCByb2xsdXAgPSB0aGlzLmdldFJvbGx1cCh0aGlzLnRvY0RhdGEsIGV2ZW50LmRhdGEuc2JVbmlxdWVJZGVudGlmaWVyKTtcclxuICAgIGlmIChyb2xsdXAubGVuZ3RoKSB7XHJcbiAgICAgIHJvbGx1cC5wb3AoKTtcclxuICAgIH1cclxuICAgIHRoaXMudG9jQ2FyZENsaWNrLmVtaXQoeyAuLi5ldmVudCwgcm9sbHVwIH0pO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGNvbGxhcHNlZENoYW5nZUhhbmRsZXIoZXZlbnQpIHtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZmlyc3ROb25Db2xsZWN0aW9uQ29udGVudChjb250ZW50cykge1xyXG4gICAgcmV0dXJuIGNvbnRlbnRzLmZpbmQoKGNvbnRlbnQpID0+IGNvbnRlbnQubWltZVR5cGUgIT09ICdhcHBsaWNhdGlvbi92bmQuZWtzdGVwLmNvbnRlbnQtY29sbGVjdGlvbicpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBmbGF0dGVuRGVlcChjb250ZW50cykge1xyXG4gICAgaWYgKGNvbnRlbnRzKSB7XHJcbiAgICAgIHJldHVybiBjb250ZW50cy5yZWR1Y2UoKGFjYywgdmFsKSA9PiB7XHJcbiAgICAgICAgaWYgKHZhbC5jaGlsZHJlbikge1xyXG4gICAgICAgICAgYWNjLnB1c2godmFsKTtcclxuICAgICAgICAgIHJldHVybiBhY2MuY29uY2F0KHRoaXMuZmxhdHRlbkRlZXAodmFsLmNoaWxkcmVuKSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJldHVybiBhY2MuY29uY2F0KHZhbCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9LCBbXSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBpc0V4cGFuZGVkKGluZGV4OiBudW1iZXIsIGl0ZW0pIHtcclxuICAgIHJldHVybiBCb29sZWFuKGluZGV4ID09PSAwIHx8IGl0ZW0gJiYgaXRlbS5taW1lVHlwZSAhPT0gTWltZVR5cGVNYXN0ZXJEYXRhLkNPTExFQ1RJT04pO1xyXG4gIH1cclxuXHJcbiAgaXNTaG93Qm9keShpdGVtLCBpbmRleCkge1xyXG4gICAgaWYgKGl0ZW0pIHtcclxuICAgICAgY29uc3QgaXNTaG93QWxsTWltZVR5cGUgPSAoKSA9PiB0aGlzLmFjdGl2ZU1pbWVUeXBlRmlsdGVyLmluZGV4T2YoJ2FsbCcpID4gLTE7XHJcbiAgICAgIGNvbnN0IGlzQ29sbGVjdGlvbiA9ICgpID0+IGl0ZW0ubWltZVR5cGUgPT09IE1pbWVUeXBlTWFzdGVyRGF0YS5DT0xMRUNUSU9OO1xyXG4gICAgICBjb25zdCBpc01hdGhjaGVzTWltZVR5cGUgPSAoKSA9PiB0aGlzLmFjdGl2ZU1pbWVUeXBlRmlsdGVyLmluZGV4T2YoaXRlbS5taW1lVHlwZSkgPiAtMTtcclxuICAgICAgY29uc3QgaXNMYXN0Q29udGVudCA9ICgpID0+IHRoaXMudG9jRGF0YS5jaGlsZHJlbi5sZW5ndGggPT09IGluZGV4ICsgMTtcclxuXHJcbiAgICAgIGlmICh0aGlzLnRvY0RhdGEgJiYgaXNTaG93QWxsTWltZVR5cGUoKSB8fCAoaXNDb2xsZWN0aW9uKCkgfHwgaXNNYXRoY2hlc01pbWVUeXBlKCkpKSB7XHJcbiAgICAgICAgdGhpcy5pc01pbWVUeXBlRmlsdGVyQ2hhbmdlZCA9IHRydWU7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5hY3RpdmVNaW1lVHlwZUZpbHRlci5pbmRleE9mKGl0ZW0ubWltZVR5cGUpIDwgMCAmJiAhaXNMYXN0Q29udGVudCgpKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9IGVsc2UgaWYgKHRoaXMuYWN0aXZlTWltZVR5cGVGaWx0ZXIuaW5kZXhPZihpdGVtLm1pbWVUeXBlKSA8IDAgJiYgaXNMYXN0Q29udGVudCgpKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNNaW1lVHlwZUZpbHRlckNoYW5nZWQpIHtcclxuICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pc01pbWVUeXBlRmlsdGVyQ2hhbmdlZCA9IGZhbHNlO1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgZ2V0Um9sbHVwKHRyZWUsIGlkZW50aWZpZXIpIHtcclxuICAgIGxldCByb2xsdXAgPSBbdHJlZS5pZGVudGlmaWVyXTtcclxuICAgIGlmICh0cmVlLnNiVW5pcXVlSWRlbnRpZmllciA9PT0gaWRlbnRpZmllcikge1xyXG4gICAgICByZXR1cm4gcm9sbHVwO1xyXG4gICAgfVxyXG4gICAgaWYgKCF0cmVlLmNoaWxkcmVuIHx8ICF0cmVlLmNoaWxkcmVuLmxlbmd0aCkge1xyXG4gICAgICByZXR1cm4gW107XHJcbiAgICB9XHJcbiAgICBsZXQgbm90RG9uZSA9IHRydWU7XHJcbiAgICBsZXQgY2hpbGRSb2xsdXA6IGFueTtcclxuICAgIGxldCBpbmRleCA9IDA7XHJcbiAgICB3aGlsZSAobm90RG9uZSAmJiB0cmVlLmNoaWxkcmVuW2luZGV4XSkge1xyXG4gICAgICBjaGlsZFJvbGx1cCA9IHRoaXMuZ2V0Um9sbHVwKHRyZWUuY2hpbGRyZW5baW5kZXhdLCBpZGVudGlmaWVyKTtcclxuICAgICAgaWYgKGNoaWxkUm9sbHVwICYmIGNoaWxkUm9sbHVwLmxlbmd0aCkge1xyXG4gICAgICAgIG5vdERvbmUgPSBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgICBpbmRleCsrO1xyXG4gICAgfVxyXG4gICAgaWYgKGNoaWxkUm9sbHVwICYmIGNoaWxkUm9sbHVwLmxlbmd0aCkge1xyXG4gICAgICByb2xsdXAucHVzaCguLi5jaGlsZFJvbGx1cCk7XHJcbiAgICAgIHJldHVybiByb2xsdXA7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gW107XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBjcmVhdGVVbmlxdWVJZCh0b2NEYXRhLCBpdGVtKSB7XHJcbiAgICBpdGVtWydzYlVuaXF1ZUlkZW50aWZpZXInXSA9IHRvY0RhdGEuaWRlbnRpZmllciArICdfJyArIGl0ZW0uaWRlbnRpZmllcjtcclxuICB9XHJcblxyXG4gIGZldGNoUHJvZ3Jlc3MoaXRlbT8pIHtcclxuICAgIHZhciBiZ0NvbG9yID0gdGhpcy5wcm9ncmVzc0NvbG9yO1xyXG4gICAgbGV0IHdpZHRoU3R5bGUgPSBpdGVtLnByb2dyZXNzUGVyY2VudGFnZSE9bnVsbD9pdGVtLnByb2dyZXNzUGVyY2VudGFnZStcIiVcIjpcIjIlXCI7XHJcbiAgICBcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHdpZHRoOiB3aWR0aFN0eWxlLFxyXG4gICAgICAnYmFja2dyb3VuZC1jb2xvcic6YmdDb2xvclxyXG4gICAgfTtcclxuICB9XHJcbiAgc2hvd0NvbXBsZXRlZChpdGVtPykge1xyXG4gICAgaWYoaXRlbSE9bnVsbCAmJiBpdGVtLnByb2dyZXNzUGVyY2VudGFnZSE9bnVsbCAmJiBpdGVtLnByb2dyZXNzUGVyY2VudGFnZSA9PT0gMTAwKSB7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxuICBmZXRjaFByb2dyZXNzU2hhZG93KGl0ZW0pIHtcclxuICAgIHZhciBiZ0NvbG9yID0gdGhpcy5zaGFkb3dDb2xvcjtcclxuICAgIGxldCBkaXNwbGF5U3RhdHVzID0gaXRlbS5wcm9ncmVzc1BlcmNlbnRhZ2UhPW51bGwgJiYgaXRlbS5wcm9ncmVzc1BlcmNlbnRhZ2UgIT0gXCIwXCI/J2Jsb2NrJzonbm9uZSc7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAnYmFja2dyb3VuZCc6YmdDb2xvcixcclxuICAgICAgZGlzcGxheTogZGlzcGxheVN0YXR1c1xyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIG9uUGxheUJ1dHRvbkNsaWNrKGV2ZW50KSB7XHJcbiAgICBjb25zdCByb2xsdXAgPSB0aGlzLmdldFJvbGx1cCh0aGlzLnRvY0RhdGEsIGV2ZW50LmRhdGEuc2JVbmlxdWVJZGVudGlmaWVyKTtcclxuICAgIGlmIChyb2xsdXAubGVuZ3RoKSB7XHJcbiAgICAgIHJvbGx1cC5wb3AoKTtcclxuICAgIH1cclxuICAgIHRoaXMudG9jQ2FyZENsaWNrLmVtaXQoeyAuLi5ldmVudCwgcm9sbHVwIH0pO1xyXG4gIH1cclxuXHJcbn1cclxuIl19